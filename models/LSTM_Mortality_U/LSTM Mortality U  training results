/Users/luis/opt/anaconda3/envs/CS598FinalProject/bin/python /Users/luis/PycharmProjects/clinical-fusion/main.py 
Use the last 24 collections data
Use the last 24 collections data
Use the last 24 collections data
start epoch : 0
train   mortality   4   lstm
100%|██████████| 243/243 [03:11<00:00,  1.27it/s]
1 (0.2665410878267012, 0.7023385467575747, 0.2222360896108091)
Avg [0.2665410878267012, 0.7023385467575747, 0.2222360896108091]

train Epoch 0 (lr 0.000100)
loss: 0.6281 	
Running time: 191.11610198020935
valid   mortality   4   lstm
100%|██████████| 35/35 [01:50<00:00,  3.15s/it]
1 (0.31094049904030713, 0.7943195929976365, 0.29665564533346234)
Avg [0.31094049904030713, 0.7943195929976365, 0.29665564533346234]

valid Epoch 0 (lr 0.000100)
loss: 0.5560 	
				 best epoch: 0     best AUC: 0.7943 	
start epoch : 1
train   mortality   4   lstm
100%|██████████| 243/243 [03:28<00:00,  1.16it/s]
1 (0.3528410702467618, 0.8057373532903335, 0.3266627902262255)
Avg [0.3528410702467618, 0.8057373532903335, 0.3266627902262255]

train Epoch 1 (lr 0.000100)
loss: 0.5328 	
Running time: 208.82293105125427
valid   mortality   4   lstm
100%|██████████| 35/35 [01:51<00:00,  3.18s/it]
1 (0.3236459709379128, 0.8123222369106278, 0.34556728535337444)
Avg [0.3236459709379128, 0.8123222369106278, 0.34556728535337444]

valid Epoch 1 (lr 0.000100)
loss: 0.5292 	
				 best epoch: 1     best AUC: 0.8123 	
start epoch : 2
train   mortality   4   lstm
100%|██████████| 243/243 [02:36<00:00,  1.55it/s]
1 (0.3554357592093441, 0.8204603218616147, 0.36227743685200614)
Avg [0.3554357592093441, 0.8204603218616147, 0.36227743685200614]

train Epoch 2 (lr 0.000100)
loss: 0.5157 	
Running time: 156.6697506904602
valid   mortality   4   lstm
100%|██████████| 35/35 [02:11<00:00,  3.76s/it]
1 (0.3603174603174603, 0.8220876897808755, 0.3621018658553375)
Avg [0.3603174603174603, 0.8220876897808755, 0.3621018658553375]

valid Epoch 2 (lr 0.000100)
loss: 0.5236 	
				 best epoch: 2     best AUC: 0.8221 	
start epoch : 3
train   mortality   4   lstm
100%|██████████| 243/243 [02:40<00:00,  1.51it/s]
1 (0.38894815446981007, 0.8283854934048313, 0.3828415810391182)
Avg [0.38894815446981007, 0.8283854934048313, 0.3828415810391182]

train Epoch 3 (lr 0.000100)
loss: 0.5057 	
Running time: 160.63102293014526
valid   mortality   4   lstm
100%|██████████| 35/35 [01:54<00:00,  3.26s/it]
1 (0.3360544217687075, 0.8244041180947802, 0.3738470846519177)
Avg [0.3360544217687075, 0.8244041180947802, 0.3738470846519177]

valid Epoch 3 (lr 0.000100)
loss: 0.5170 	
				 best epoch: 3     best AUC: 0.8244 	
start epoch : 4
train   mortality   4   lstm
100%|██████████| 243/243 [03:53<00:00,  1.04it/s]
1 (0.3739805825242718, 0.8321684973541541, 0.39064813163294876)
Avg [0.3739805825242718, 0.8321684973541541, 0.39064813163294876]

train Epoch 4 (lr 0.000100)
loss: 0.4988 	
Running time: 234.026184797287
valid   mortality   4   lstm
100%|██████████| 35/35 [01:45<00:00,  3.00s/it]
1 (0.3469387755102041, 0.8263299683531626, 0.3707424887768073)
Avg [0.3469387755102041, 0.8263299683531626, 0.3707424887768073]

valid Epoch 4 (lr 0.000100)
loss: 0.5141 	
				 best epoch: 4     best AUC: 0.8263 	
start epoch : 5
train   mortality   4   lstm
100%|██████████| 243/243 [02:55<00:00,  1.38it/s]
1 (0.3828520392974099, 0.8368836618254042, 0.39803996588807056)
Avg [0.3828520392974099, 0.8368836618254042, 0.39803996588807056]

train Epoch 5 (lr 0.000100)
loss: 0.4954 	
Running time: 175.8320369720459
valid   mortality   4   lstm
100%|██████████| 35/35 [01:45<00:00,  3.01s/it]
1 (0.34609720176730485, 0.8229840163441893, 0.37560991836582525)
Avg [0.34609720176730485, 0.8229840163441893, 0.37560991836582525]

valid Epoch 5 (lr 0.000100)
loss: 0.5173 	
				 best epoch: 4     best AUC: 0.8263 	
start epoch : 6
train   mortality   4   lstm
100%|██████████| 243/243 [02:31<00:00,  1.61it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.40231896740319406, 0.8393836385048996, 0.40896042831278595)
Avg [0.40231896740319406, 0.8393836385048996, 0.40896042831278595]

train Epoch 6 (lr 0.000100)
loss: 0.4906 	
Running time: 151.0986487865448
valid   mortality   4   lstm
100%|██████████| 35/35 [01:47<00:00,  3.06s/it]
1 (0.32364096080910243, 0.8221698113207546, 0.37263748790546325)
Avg [0.32364096080910243, 0.8221698113207546, 0.37263748790546325]

valid Epoch 6 (lr 0.000100)
loss: 0.5145 	
				 best epoch: 4     best AUC: 0.8263 	
start epoch : 7
train   mortality   4   lstm
100%|██████████| 243/243 [02:50<00:00,  1.42it/s]
1 (0.38547763118738215, 0.8409028067890431, 0.4141177722715879)
Avg [0.38547763118738215, 0.8409028067890431, 0.4141177722715879]

train Epoch 7 (lr 0.000100)
loss: 0.4881 	
Running time: 170.66668105125427
valid   mortality   4   lstm
100%|██████████| 35/35 [01:58<00:00,  3.40s/it]
1 (0.3636363636363637, 0.8286514040780355, 0.38484350171082843)
Avg [0.3636363636363637, 0.8286514040780355, 0.38484350171082843]

valid Epoch 7 (lr 0.000100)
loss: 0.5082 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 8
train   mortality   4   lstm
100%|██████████| 243/243 [03:08<00:00,  1.29it/s]
1 (0.386089006778662, 0.8433396322852561, 0.4169900035483369)
Avg [0.386089006778662, 0.8433396322852561, 0.4169900035483369]

train Epoch 8 (lr 0.000100)
loss: 0.4887 	
Running time: 189.0375852584839
valid   mortality   4   lstm
100%|██████████| 35/35 [01:47<00:00,  3.07s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.3440111420612813, 0.8252964387293193, 0.3827594863309861)
Avg [0.3440111420612813, 0.8252964387293193, 0.3827594863309861]

valid Epoch 8 (lr 0.000100)
loss: 0.5144 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 9
train   mortality   4   lstm
100%|██████████| 243/243 [02:40<00:00,  1.51it/s]
1 (0.4029690189328744, 0.8455006161630385, 0.4250335842002343)
Avg [0.4029690189328744, 0.8455006161630385, 0.4250335842002343]

train Epoch 9 (lr 0.000100)
loss: 0.4798 	
Running time: 160.94458103179932
valid   mortality   4   lstm
100%|██████████| 35/35 [01:58<00:00,  3.39s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.3159144893111639, 0.8230921764211031, 0.38072216905186373)
Avg [0.3159144893111639, 0.8230921764211031, 0.38072216905186373]

valid Epoch 9 (lr 0.000100)
loss: 0.5132 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 10
train   mortality   4   lstm
100%|██████████| 243/243 [03:08<00:00,  1.29it/s]
1 (0.3879824910465579, 0.8455920585561333, 0.4226957926356534)
Avg [0.3879824910465579, 0.8455920585561333, 0.4226957926356534]

train Epoch 10 (lr 0.000100)
loss: 0.4821 	
Running time: 188.8627438545227
valid   mortality   4   lstm
100%|██████████| 35/35 [01:47<00:00,  3.08s/it]
1 (0.3518796992481203, 0.8244081240235548, 0.3832911903397006)
Avg [0.3518796992481203, 0.8244081240235548, 0.3832911903397006]

valid Epoch 10 (lr 0.000100)
loss: 0.5142 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 11
train   mortality   4   lstm
100%|██████████| 243/243 [02:37<00:00,  1.55it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.38149628783552253, 0.8466893208180826, 0.4242354482991398)
Avg [0.38149628783552253, 0.8466893208180826, 0.4242354482991398]

train Epoch 11 (lr 0.000100)
loss: 0.4788 	
Running time: 157.31990385055542
valid   mortality   4   lstm
100%|██████████| 35/35 [01:42<00:00,  2.93s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.3281653746770026, 0.8260695829828145, 0.38549648034199885)
Avg [0.3281653746770026, 0.8260695829828145, 0.38549648034199885]

valid Epoch 11 (lr 0.000100)
loss: 0.5095 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 12
train   mortality   4   lstm
100%|██████████| 243/243 [02:45<00:00,  1.47it/s]
1 (0.40287769784172667, 0.85153745862097, 0.4305341693994463)
Avg [0.40287769784172667, 0.85153745862097, 0.4305341693994463]

train Epoch 12 (lr 0.000100)
loss: 0.4726 	
Running time: 165.59937286376953
valid   mortality   4   lstm
100%|██████████| 35/35 [01:40<00:00,  2.87s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.33178500331785005, 0.8237801946881385, 0.3841144560864158)
Avg [0.33178500331785005, 0.8237801946881385, 0.3841144560864158]

valid Epoch 12 (lr 0.000100)
loss: 0.5243 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 13
train   mortality   4   lstm
100%|██████████| 243/243 [02:22<00:00,  1.70it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.390668860710483, 0.8526359751730094, 0.4353461632990468)
Avg [0.390668860710483, 0.8526359751730094, 0.4353461632990468]

train Epoch 13 (lr 0.000100)
loss: 0.4708 	
Running time: 142.99211597442627
valid   mortality   4   lstm
100%|██████████| 35/35 [01:41<00:00,  2.89s/it]
1 (0.33536999321113375, 0.8240756319352641, 0.38965163694486027)
Avg [0.33536999321113375, 0.8240756319352641, 0.38965163694486027]

valid Epoch 13 (lr 0.000100)
loss: 0.5264 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 14
train   mortality   4   lstm
100%|██████████| 243/243 [02:45<00:00,  1.47it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.3917122752150118, 0.8532458203059048, 0.43166861749731295)
Avg [0.3917122752150118, 0.8532458203059048, 0.43166861749731295]

train Epoch 14 (lr 0.000100)
loss: 0.4669 	
Running time: 165.51210594177246
valid   mortality   4   lstm
100%|██████████| 35/35 [01:40<00:00,  2.88s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.3320463320463321, 0.8235949204823139, 0.3853885542172067)
Avg [0.3320463320463321, 0.8235949204823139, 0.3853885542172067]

valid Epoch 14 (lr 0.000100)
loss: 0.5288 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 15
train   mortality   4   lstm
100%|██████████| 243/243 [02:29<00:00,  1.63it/s]
1 (0.40402381441182506, 0.8575751186902194, 0.4474383588886457)
Avg [0.40402381441182506, 0.8575751186902194, 0.4474383588886457]

train Epoch 15 (lr 0.000100)
loss: 0.4612 	
Running time: 149.38150191307068
valid   mortality   4   lstm
100%|██████████| 35/35 [01:57<00:00,  3.35s/it]
1 (0.33267587113740954, 0.821024115691223, 0.385042836133971)
Avg [0.33267587113740954, 0.821024115691223, 0.385042836133971]

valid Epoch 15 (lr 0.000100)
loss: 0.5370 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 16
train   mortality   4   lstm
100%|██████████| 243/243 [04:41<00:00,  1.16s/it]
1 (0.40966894377298996, 0.8597130236303422, 0.4435738472134871)
Avg [0.40966894377298996, 0.8597130236303422, 0.4435738472134871]

train Epoch 16 (lr 0.000100)
loss: 0.4582 	
Running time: 281.6811809539795
valid   mortality   4   lstm
100%|██████████| 35/35 [01:46<00:00,  3.03s/it]
1 (0.35053110773899854, 0.8183711893602532, 0.3875735477780147)
Avg [0.35053110773899854, 0.8183711893602532, 0.3875735477780147]

valid Epoch 16 (lr 0.000100)
loss: 0.5378 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 17
train   mortality   4   lstm
100%|██████████| 243/243 [03:01<00:00,  1.34it/s]
1 (0.41097625329815307, 0.8611725713255312, 0.45654364269084513)
Avg [0.41097625329815307, 0.8611725713255312, 0.45654364269084513]

train Epoch 17 (lr 0.000100)
loss: 0.4531 	
Running time: 181.16390013694763
valid   mortality   4   lstm
100%|██████████| 35/35 [01:50<00:00,  3.16s/it]
1 (0.3440233236151603, 0.8165985658774987, 0.38962754163409297)
Avg [0.3440233236151603, 0.8165985658774987, 0.38962754163409297]

valid Epoch 17 (lr 0.000100)
loss: 0.5548 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 18
train   mortality   4   lstm
100%|██████████| 243/243 [03:29<00:00,  1.16it/s]
1 (0.4110796348756688, 0.8621308675365233, 0.4596772774560016)
Avg [0.4110796348756688, 0.8621308675365233, 0.4596772774560016]

train Epoch 18 (lr 0.000100)
loss: 0.4554 	
Running time: 209.65333890914917
valid   mortality   4   lstm
100%|██████████| 35/35 [01:50<00:00,  3.14s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.3331000699790063, 0.8131394463806433, 0.3802758150397436)
Avg [0.3331000699790063, 0.8131394463806433, 0.3802758150397436]

valid Epoch 18 (lr 0.000100)
loss: 0.5478 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 19
train   mortality   4   lstm
100%|██████████| 243/243 [03:10<00:00,  1.27it/s]
1 (0.4102459016393442, 0.8655821628576943, 0.46584547990556513)
Avg [0.4102459016393442, 0.8655821628576943, 0.46584547990556513]

train Epoch 19 (lr 0.000100)
loss: 0.4514 	
  0%|          | 0/35 [00:00<?, ?it/s]Running time: 191.04114484786987
valid   mortality   4   lstm
100%|██████████| 35/35 [01:58<00:00,  3.39s/it]
1 (0.3417159763313609, 0.8167658134038378, 0.38611359207122875)
Avg [0.3417159763313609, 0.8167658134038378, 0.38611359207122875]

valid Epoch 19 (lr 0.000100)
loss: 0.5568 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 20
train   mortality   4   lstm
100%|██████████| 243/243 [04:12<00:00,  1.04s/it]
1 (0.4137787056367432, 0.8681606580968365, 0.47269737636920445)
Avg [0.4137787056367432, 0.8681606580968365, 0.47269737636920445]

train Epoch 20 (lr 0.000100)
loss: 0.4447 	
Running time: 252.43129801750183
valid   mortality   4   lstm
100%|██████████| 35/35 [02:07<00:00,  3.63s/it]
1 (0.34142752023546724, 0.8121469775267397, 0.3763478920291276)
Avg [0.34142752023546724, 0.8121469775267397, 0.3763478920291276]

valid Epoch 20 (lr 0.000100)
loss: 0.5610 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 21
train   mortality   4   lstm
100%|██████████| 243/243 [03:12<00:00,  1.26it/s]
1 (0.40970893342733405, 0.8704139484342205, 0.47877185006013895)
Avg [0.40970893342733405, 0.8704139484342205, 0.47877185006013895]

train Epoch 21 (lr 0.000100)
loss: 0.4411 	
Running time: 192.63637709617615
valid   mortality   4   lstm
100%|██████████| 35/35 [01:47<00:00,  3.08s/it]
1 (0.3342465753424657, 0.8162260145014621, 0.3850801347344137)
Avg [0.3342465753424657, 0.8162260145014621, 0.3850801347344137]

valid Epoch 21 (lr 0.000100)
loss: 0.5493 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 22
train   mortality   4   lstm
100%|██████████| 243/243 [02:31<00:00,  1.60it/s]
1 (0.41996847083552286, 0.871251451864007, 0.4786144500280948)
Avg [0.41996847083552286, 0.871251451864007, 0.4786144500280948]

train Epoch 22 (lr 0.000100)
loss: 0.4409 	
Running time: 151.95503783226013
valid   mortality   4   lstm
100%|██████████| 35/35 [01:48<00:00,  3.09s/it]
1 (0.34340456890198967, 0.8165284621239435, 0.3870824652661132)
Avg [0.34340456890198967, 0.8165284621239435, 0.3870824652661132]

valid Epoch 22 (lr 0.000100)
loss: 0.5463 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 23
train   mortality   4   lstm
100%|██████████| 243/243 [02:31<00:00,  1.60it/s]
1 (0.41738594327990136, 0.8755232108518131, 0.4892054147414172)
Avg [0.41738594327990136, 0.8755232108518131, 0.4892054147414172]

train Epoch 23 (lr 0.000100)
loss: 0.4352 	
Running time: 151.6370029449463
valid   mortality   4   lstm
100%|██████████| 35/35 [02:04<00:00,  3.55s/it]
1 (0.316447779862414, 0.8083673837279173, 0.37324493620304655)
Avg [0.316447779862414, 0.8083673837279173, 0.37324493620304655]

valid Epoch 23 (lr 0.000100)
loss: 0.5767 	
				 best epoch: 7     best AUC: 0.8287 	
start epoch : 24
train   mortality   4   lstm
100%|██████████| 243/243 [02:33<00:00,  1.58it/s]
1 (0.4234822934232714, 0.8762708978201033, 0.48695424295016654)
Avg [0.4234822934232714, 0.8762708978201033, 0.48695424295016654]

train Epoch 24 (lr 0.000100)
loss: 0.4307 	
Running time: 153.9387629032135
valid   mortality   4   lstm
100%|██████████| 35/35 [01:48<00:00,  3.09s/it]
1 (0.3335689045936396, 0.8083864118895966, 0.37960733273367464)
Avg [0.3335689045936396, 0.8083864118895966, 0.37960733273367464]

valid Epoch 24 (lr 0.000100)
loss: 0.5745 	
				 best epoch: 7     best AUC: 0.8287 	
best metric [0.8286514040780355, 7]

Process finished with exit code 0