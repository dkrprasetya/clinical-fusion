/Users/luis/opt/anaconda3/envs/CS598FinalProject/bin/python /Users/luis/PycharmProjects/clinical-fusion/main.py 
Use the last 24 collections data
Use the last 24 collections data
Use the last 24 collections data
start epoch : 0
train   llos   4   lstm
100%|██████████| 243/243 [02:31<00:00,  1.61it/s]
1 (0.6210393898891423, 0.6400621789763359, 0.6072729151237917)
Avg [0.6210393898891423, 0.6400621789763359, 0.6072729151237917]

train Epoch 0 (lr 0.000100)
loss: 0.6632 	
Running time: 151.13624501228333
valid   llos   4   lstm
100%|██████████| 35/35 [01:40<00:00,  2.87s/it]
1 (0.6564073866815893, 0.6924821010371361, 0.6651415056239582)
Avg [0.6564073866815893, 0.6924821010371361, 0.6651415056239582]

valid Epoch 0 (lr 0.000100)
loss: 0.6340 	
				 best epoch: 0     best AUC: 0.6925 	
start epoch : 1
train   llos   4   lstm
100%|██████████| 243/243 [02:35<00:00,  1.56it/s]
1 (0.6601042269832079, 0.7122543343402468, 0.6735665056371325)
Avg [0.6601042269832079, 0.7122543343402468, 0.6735665056371325]

train Epoch 1 (lr 0.000100)
loss: 0.6219 	
Running time: 155.8668999671936
valid   llos   4   lstm
100%|██████████| 35/35 [01:40<00:00,  2.88s/it]
1 (0.6822376009227221, 0.7299821010371361, 0.7030501541521805)
Avg [0.6822376009227221, 0.7299821010371361, 0.7030501541521805]

valid Epoch 1 (lr 0.000100)
loss: 0.6076 	
				 best epoch: 1     best AUC: 0.7300 	
start epoch : 2
train   llos   4   lstm
100%|██████████| 243/243 [02:16<00:00,  1.79it/s]
1 (0.6816380449141346, 0.7301130885724112, 0.6981404448405546)
Avg [0.6816380449141346, 0.7301130885724112, 0.6981404448405546]

train Epoch 2 (lr 0.000100)
loss: 0.6079 	
Running time: 136.17209315299988
valid   llos   4   lstm
100%|██████████| 35/35 [01:44<00:00,  2.99s/it]
1 (0.6999451453647834, 0.737893275342924, 0.718068736327902)
Avg [0.6999451453647834, 0.737893275342924, 0.718068736327902]

valid Epoch 2 (lr 0.000100)
loss: 0.6128 	
				 best epoch: 2     best AUC: 0.7379 	
start epoch : 3
train   llos   4   lstm
100%|██████████| 243/243 [02:23<00:00,  1.69it/s]
1 (0.6687212394984591, 0.7372626429469662, 0.7079257337842886)
Avg [0.6687212394984591, 0.7372626429469662, 0.7079257337842886]

train Epoch 3 (lr 0.000100)
loss: 0.6027 	
Running time: 143.8950047492981
valid   llos   4   lstm
100%|██████████| 35/35 [01:40<00:00,  2.87s/it]
1 (0.6961602671118532, 0.7444302442288391, 0.7246784159519064)
Avg [0.6961602671118532, 0.7444302442288391, 0.7246784159519064]

valid Epoch 3 (lr 0.000100)
loss: 0.5986 	
				 best epoch: 3     best AUC: 0.7444 	
start epoch : 4
train   llos   4   lstm
100%|██████████| 243/243 [02:20<00:00,  1.73it/s]
1 (0.6744331183690452, 0.7405725077389907, 0.7116486442069452)
Avg [0.6744331183690452, 0.7405725077389907, 0.7116486442069452]

train Epoch 4 (lr 0.000100)
loss: 0.5973 	
Running time: 140.18938994407654
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.84s/it]
1 (0.7009244154431756, 0.7406697892271663, 0.7226658261564336)
Avg [0.7009244154431756, 0.7406697892271663, 0.7226658261564336]

valid Epoch 4 (lr 0.000100)
loss: 0.6061 	
				 best epoch: 3     best AUC: 0.7444 	
start epoch : 5
train   llos   4   lstm
100%|██████████| 243/243 [02:19<00:00,  1.74it/s]
1 (0.6763697197825178, 0.7461230463334081, 0.71991044106651)
Avg [0.6763697197825178, 0.7461230463334081, 0.71991044106651]

train Epoch 5 (lr 0.000100)
loss: 0.5918 	
Running time: 139.85099077224731
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.84s/it]
1 (0.7073237135856247, 0.7443673469387755, 0.7252353605739306)
Avg [0.7073237135856247, 0.7443673469387755, 0.7252353605739306]

valid Epoch 5 (lr 0.000100)
loss: 0.5941 	
				 best epoch: 3     best AUC: 0.7444 	
start epoch : 6
train   llos   4   lstm
100%|██████████| 243/243 [02:21<00:00,  1.72it/s]
1 (0.6799615368535473, 0.7497195597647336, 0.7249125836608044)
Avg [0.6799615368535473, 0.7497195597647336, 0.7249125836608044]

train Epoch 6 (lr 0.000100)
loss: 0.5874 	
Running time: 141.48113703727722
valid   llos   4   lstm
100%|██████████| 35/35 [01:40<00:00,  2.86s/it]
1 (0.6956025128498001, 0.7484705587152894, 0.7273537428669751)
Avg [0.6956025128498001, 0.7484705587152894, 0.7273537428669751]

valid Epoch 6 (lr 0.000100)
loss: 0.5926 	
				 best epoch: 6     best AUC: 0.7485 	
start epoch : 7
train   llos   4   lstm
100%|██████████| 243/243 [02:20<00:00,  1.73it/s]
1 (0.6837195804485718, 0.7525310857317078, 0.7291681812168993)
Avg [0.6837195804485718, 0.7525310857317078, 0.7291681812168993]

train Epoch 7 (lr 0.000100)
loss: 0.5857 	
Running time: 140.7696189880371
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.86s/it]
1 (0.705131761442441, 0.7490812980930077, 0.7285516812982449)
Avg [0.705131761442441, 0.7490812980930077, 0.7285516812982449]

valid Epoch 7 (lr 0.000100)
loss: 0.5914 	
				 best epoch: 7     best AUC: 0.7491 	
start epoch : 8
train   llos   4   lstm
100%|██████████| 243/243 [02:20<00:00,  1.73it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.6871393239901071, 0.7541918064912176, 0.7306952563981177)
Avg [0.6871393239901071, 0.7541918064912176, 0.7306952563981177]

train Epoch 8 (lr 0.000100)
loss: 0.5831 	
Running time: 140.4805769920349
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.86s/it]
1 (0.6876456876456876, 0.7474600200736032, 0.7270637167171538)
Avg [0.6876456876456876, 0.7474600200736032, 0.7270637167171538]

valid Epoch 8 (lr 0.000100)
loss: 0.5933 	
				 best epoch: 7     best AUC: 0.7491 	
start epoch : 9
train   llos   4   lstm
100%|██████████| 243/243 [02:18<00:00,  1.75it/s]
1 (0.6845319705845694, 0.7557305379168885, 0.7331515384185406)
Avg [0.6845319705845694, 0.7557305379168885, 0.7331515384185406]

train Epoch 9 (lr 0.000100)
loss: 0.5833 	
Running time: 138.7203860282898
valid   llos   4   lstm
100%|██████████| 35/35 [01:38<00:00,  2.83s/it]
1 (0.6943244021895708, 0.7514442957510874, 0.7277586818514231)
Avg [0.6943244021895708, 0.7514442957510874, 0.7277586818514231]

valid Epoch 9 (lr 0.000100)
loss: 0.5918 	
				 best epoch: 9     best AUC: 0.7514 	
start epoch : 10
train   llos   4   lstm
100%|██████████| 243/243 [02:18<00:00,  1.76it/s]
1 (0.685704812036308, 0.7577005895046963, 0.7351340954372789)
Avg [0.685704812036308, 0.7577005895046963, 0.7351340954372789]

train Epoch 10 (lr 0.000100)
loss: 0.5831 	
Running time: 138.2867078781128
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.84s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.689011949868843, 0.7499983271997324, 0.7270586185134245)
Avg [0.689011949868843, 0.7499983271997324, 0.7270586185134245]

valid Epoch 10 (lr 0.000100)
loss: 0.5941 	
				 best epoch: 9     best AUC: 0.7514 	
start epoch : 11
train   llos   4   lstm
100%|██████████| 243/243 [02:18<00:00,  1.76it/s]
1 (0.6854346189241195, 0.7592519119015857, 0.736495067872745)
Avg [0.6854346189241195, 0.7592519119015857, 0.736495067872745]

train Epoch 11 (lr 0.000100)
loss: 0.5796 	
Running time: 138.48746800422668
valid   llos   4   lstm
100%|██████████| 35/35 [01:40<00:00,  2.88s/it]
1 (0.7098901098901099, 0.7522459016393442, 0.7285109472878686)
Avg [0.7098901098901099, 0.7522459016393442, 0.7285109472878686]

valid Epoch 11 (lr 0.000100)
loss: 0.5932 	
				 best epoch: 11     best AUC: 0.7522 	
start epoch : 12
train   llos   4   lstm
100%|██████████| 243/243 [02:20<00:00,  1.73it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.6800906331495019, 0.7622956246665289, 0.7417657438321026)
Avg [0.6800906331495019, 0.7622956246665289, 0.7417657438321026]

train Epoch 12 (lr 0.000100)
loss: 0.5756 	
Running time: 140.4658260345459
valid   llos   4   lstm
100%|██████████| 35/35 [01:40<00:00,  2.87s/it]
1 (0.7117631078511275, 0.75014787554366, 0.7234758752458048)
Avg [0.7117631078511275, 0.75014787554366, 0.7234758752458048]

valid Epoch 12 (lr 0.000100)
loss: 0.5962 	
				 best epoch: 11     best AUC: 0.7522 	
start epoch : 13
train   llos   4   lstm
100%|██████████| 243/243 [02:31<00:00,  1.60it/s]
1 (0.6971085607688876, 0.7639188832740814, 0.7427597007279125)
Avg [0.6971085607688876, 0.7639188832740814, 0.7427597007279125]

train Epoch 13 (lr 0.000100)
loss: 0.5753 	
Running time: 151.95121884346008
valid   llos   4   lstm
100%|██████████| 35/35 [01:46<00:00,  3.05s/it]
1 (0.6919075144508671, 0.7543737035797926, 0.7291149366904314)
Avg [0.6919075144508671, 0.7543737035797926, 0.7291149366904314]

valid Epoch 13 (lr 0.000100)
loss: 0.5868 	
				 best epoch: 13     best AUC: 0.7544 	
start epoch : 14
train   llos   4   lstm
100%|██████████| 243/243 [02:22<00:00,  1.71it/s]
1 (0.6834881936748786, 0.7659315775138026, 0.7468529276382769)
Avg [0.6834881936748786, 0.7659315775138026, 0.7468529276382769]

train Epoch 14 (lr 0.000100)
loss: 0.5719 	
Running time: 142.18889117240906
valid   llos   4   lstm
100%|██████████| 35/35 [01:43<00:00,  2.95s/it]
1 (0.7028843461215345, 0.7534459685513549, 0.7226235309441258)
Avg [0.7028843461215345, 0.7534459685513549, 0.7226235309441258]

valid Epoch 14 (lr 0.000100)
loss: 0.5905 	
				 best epoch: 13     best AUC: 0.7544 	
start epoch : 15
train   llos   4   lstm
100%|██████████| 243/243 [02:16<00:00,  1.77it/s]
1 (0.683993714698263, 0.7675853283323695, 0.7480765975660861)
Avg [0.683993714698263, 0.7675853283323695, 0.7480765975660861]

train Epoch 15 (lr 0.000100)
loss: 0.5695 	
Running time: 137.0389449596405
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.84s/it]
1 (0.7070258261594001, 0.7533011040481766, 0.7226643348388948)
Avg [0.7070258261594001, 0.7533011040481766, 0.7226643348388948]

valid Epoch 15 (lr 0.000100)
loss: 0.5928 	
				 best epoch: 13     best AUC: 0.7544 	
start epoch : 16
train   llos   4   lstm
100%|██████████| 243/243 [02:16<00:00,  1.78it/s]
1 (0.6920455979472511, 0.7696600827076892, 0.750796953357793)
Avg [0.6920455979472511, 0.7696600827076892, 0.750796953357793]

train Epoch 16 (lr 0.000100)
loss: 0.5670 	
Running time: 136.72644710540771
valid   llos   4   lstm
100%|██████████| 35/35 [01:38<00:00,  2.82s/it]
1 (0.6993689041881813, 0.7534315824690532, 0.7242777376914404)
Avg [0.6993689041881813, 0.7534315824690532, 0.7242777376914404]

valid Epoch 16 (lr 0.000100)
loss: 0.5923 	
				 best epoch: 13     best AUC: 0.7544 	
start epoch : 17
train   llos   4   lstm
100%|██████████| 243/243 [02:18<00:00,  1.76it/s]
1 (0.6895078605604922, 0.772804963772699, 0.7547401011382701)
Avg [0.6895078605604922, 0.772804963772699, 0.7547401011382701]

train Epoch 17 (lr 0.000100)
loss: 0.5703 	
Running time: 138.0796091556549
valid   llos   4   lstm
100%|██████████| 35/35 [01:40<00:00,  2.87s/it]
1 (0.6963260619977039, 0.7540408163265306, 0.7238541255757887)
Avg [0.6963260619977039, 0.7540408163265306, 0.7238541255757887]

valid Epoch 17 (lr 0.000100)
loss: 0.5895 	
				 best epoch: 13     best AUC: 0.7544 	
start epoch : 18
train   llos   4   lstm
100%|██████████| 243/243 [02:17<00:00,  1.77it/s]
1 (0.6967949246106946, 0.7720162779026439, 0.7519909781321286)
Avg [0.6967949246106946, 0.7720162779026439, 0.7519909781321286]

train Epoch 18 (lr 0.000100)
loss: 0.5652 	
Running time: 137.38543272018433
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.85s/it]
1 (0.7101409229068805, 0.7527638006022079, 0.717903307942898)
Avg [0.7101409229068805, 0.7527638006022079, 0.717903307942898]

valid Epoch 18 (lr 0.000100)
loss: 0.5973 	
				 best epoch: 13     best AUC: 0.7544 	
start epoch : 19
train   llos   4   lstm
100%|██████████| 243/243 [02:17<00:00,  1.76it/s]
1 (0.6965847913862718, 0.7759537788759086, 0.7577989820203141)
Avg [0.6965847913862718, 0.7759537788759086, 0.7577989820203141]

train Epoch 19 (lr 0.000100)
loss: 0.5665 	
Running time: 138.02715921401978
valid   llos   4   lstm
100%|██████████| 35/35 [01:38<00:00,  2.82s/it]
1 (0.7281299109481403, 0.7549260622281699, 0.7246333687065429)
Avg [0.7281299109481403, 0.7549260622281699, 0.7246333687065429]

valid Epoch 19 (lr 0.000100)
loss: 0.5928 	
				 best epoch: 19     best AUC: 0.7549 	
start epoch : 20
train   llos   4   lstm
100%|██████████| 243/243 [02:16<00:00,  1.78it/s]
1 (0.6988426702448842, 0.7777621353467595, 0.7584189795142073)
Avg [0.6988426702448842, 0.7777621353467595, 0.7584189795142073]

train Epoch 20 (lr 0.000100)
loss: 0.5619 	
Running time: 136.4367480278015
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.84s/it]
1 (0.6953302961275627, 0.7520786216125794, 0.7216526653647428)
Avg [0.6953302961275627, 0.7520786216125794, 0.7216526653647428]

valid Epoch 20 (lr 0.000100)
loss: 0.5960 	
				 best epoch: 19     best AUC: 0.7549 	
start epoch : 21
train   llos   4   lstm
100%|██████████| 243/243 [02:19<00:00,  1.74it/s]
1 (0.6984502343651028, 0.778845631619395, 0.7612720827679809)
Avg [0.6984502343651028, 0.778845631619395, 0.7612720827679809]

train Epoch 21 (lr 0.000100)
loss: 0.5601 	
Running time: 139.33322024345398
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.83s/it]
1 (0.7159303882195448, 0.7518357310137169, 0.721153304128378)
Avg [0.7159303882195448, 0.7518357310137169, 0.721153304128378]

valid Epoch 21 (lr 0.000100)
loss: 0.5941 	
				 best epoch: 19     best AUC: 0.7549 	
start epoch : 22
train   llos   4   lstm
100%|██████████| 243/243 [02:16<00:00,  1.78it/s]
1 (0.6979888600705813, 0.7816462331174439, 0.7646436546086766)
Avg [0.6979888600705813, 0.7816462331174439, 0.7646436546086766]

train Epoch 22 (lr 0.000100)
loss: 0.5549 	
Running time: 136.72141909599304
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.84s/it]
1 (0.7048808172531215, 0.7553054533288727, 0.722059595330321)
Avg [0.7048808172531215, 0.7553054533288727, 0.722059595330321]

valid Epoch 22 (lr 0.000100)
loss: 0.5919 	
				 best epoch: 22     best AUC: 0.7553 	
start epoch : 23
train   llos   4   lstm
100%|██████████| 243/243 [02:17<00:00,  1.77it/s]
1 (0.7027505159850048, 0.7843870625055835, 0.767739735343189)
Avg [0.7027505159850048, 0.7843870625055835, 0.767739735343189]

train Epoch 23 (lr 0.000100)
loss: 0.5535 	
Running time: 137.24250078201294
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.83s/it]
1 (0.7024008933556671, 0.7523984610237536, 0.7177760009731917)
Avg [0.7024008933556671, 0.7523984610237536, 0.7177760009731917]

valid Epoch 23 (lr 0.000100)
loss: 0.5972 	
				 best epoch: 22     best AUC: 0.7553 	
start epoch : 24
train   llos   4   lstm
100%|██████████| 243/243 [02:16<00:00,  1.78it/s]
1 (0.7115305703734099, 0.785174385805116, 0.7687639298304739)
Avg [0.7115305703734099, 0.785174385805116, 0.7687639298304739]

train Epoch 24 (lr 0.000100)
loss: 0.5508 	
Running time: 136.64143085479736
valid   llos   4   lstm
100%|██████████| 35/35 [01:39<00:00,  2.84s/it]
1 (0.7142064372918979, 0.7527979257276681, 0.7147811558033712)
Avg [0.7142064372918979, 0.7527979257276681, 0.7147811558033712]

valid Epoch 24 (lr 0.000100)
loss: 0.6031 	
				 best epoch: 22     best AUC: 0.7553 	
best metric [0.7553054533288727, 22]

Process finished with exit code 0