/Users/luis/opt/anaconda3/envs/CS598FinalProject/bin/python /Users/luis/PycharmProjects/clinical-fusion/main.py 
Use the last 24 collections data
Use the last 24 collections data
Use the last 24 collections data
start epoch : 0
train   readmit   4   cnn
100%|██████████| 243/243 [02:10<00:00,  1.86it/s]
1 (0.11230969321398515, 0.5391487856107693, 0.06490991156601846)
Avg [0.11230969321398515, 0.5391487856107693, 0.06490991156601846]

train Epoch 0 (lr 0.000100)
loss: 0.7343 	
Running time: 130.72074007987976
valid   readmit   4   cnn
100%|██████████| 35/35 [01:38<00:00,  2.80s/it]
1 (0.1327700663850332, 0.5916375076734193, 0.08013672980316822)
Avg [0.1327700663850332, 0.5916375076734193, 0.08013672980316822]

valid Epoch 0 (lr 0.000100)
loss: 0.6723 	
				 best epoch: 0     best AUC: 0.5916 	
start epoch : 1
train   readmit   4   cnn
100%|██████████| 243/243 [02:03<00:00,  1.97it/s]
1 (0.1353422748650061, 0.6178181039713478, 0.09128355967244013)
Avg [0.1353422748650061, 0.6178181039713478, 0.09128355967244013]

train Epoch 1 (lr 0.000100)
loss: 0.6818 	
Running time: 123.46743297576904
valid   readmit   4   cnn
100%|██████████| 35/35 [01:38<00:00,  2.81s/it]
1 (0.15333333333333332, 0.6314886433394721, 0.09835828151581077)
Avg [0.15333333333333332, 0.6314886433394721, 0.09835828151581077]

valid Epoch 1 (lr 0.000100)
loss: 0.6585 	
				 best epoch: 1     best AUC: 0.6315 	
start epoch : 2
train   readmit   4   cnn
100%|██████████| 243/243 [02:02<00:00,  1.98it/s]
1 (0.13876238949906242, 0.6390599367053215, 0.10421321845291107)
Avg [0.13876238949906242, 0.6390599367053215, 0.10421321845291107]

train Epoch 2 (lr 0.000100)
loss: 0.6658 	
Running time: 122.9911470413208
valid   readmit   4   cnn
100%|██████████| 35/35 [01:40<00:00,  2.87s/it]
1 (0.16235632183908047, 0.6423879680785758, 0.10314231650409716)
Avg [0.16235632183908047, 0.6423879680785758, 0.10314231650409716]

valid Epoch 2 (lr 0.000100)
loss: 0.6556 	
				 best epoch: 2     best AUC: 0.6424 	
start epoch : 3
train   readmit   4   cnn
100%|██████████| 243/243 [02:02<00:00,  1.98it/s]
1 (0.15638463653863782, 0.6770635118277063, 0.11478743526175043)
Avg [0.15638463653863782, 0.6770635118277063, 0.11478743526175043]

train Epoch 3 (lr 0.000100)
loss: 0.6413 	
Running time: 122.87768006324768
valid   readmit   4   cnn
100%|██████████| 35/35 [01:37<00:00,  2.80s/it]
1 (0.17298187808896212, 0.6490845610804175, 0.11269081732438929)
Avg [0.17298187808896212, 0.6490845610804175, 0.11269081732438929]

valid Epoch 3 (lr 0.000100)
loss: 0.6514 	
  0%|          | 0/243 [00:00<?, ?it/s]				 best epoch: 3     best AUC: 0.6491 	
start epoch : 4
train   readmit   4   cnn
100%|██████████| 243/243 [02:02<00:00,  1.98it/s]
1 (0.16178331548719946, 0.6828986451562664, 0.12195326615444138)
Avg [0.16178331548719946, 0.6828986451562664, 0.12195326615444138]

train Epoch 4 (lr 0.000100)
loss: 0.6349 	
Running time: 122.73192882537842
valid   readmit   4   cnn
100%|██████████| 35/35 [01:37<00:00,  2.79s/it]
1 (0.15458937198067632, 0.6460297728667893, 0.11198426008816127)
Avg [0.15458937198067632, 0.6460297728667893, 0.11198426008816127]

valid Epoch 4 (lr 0.000100)
loss: 0.6537 	
				 best epoch: 3     best AUC: 0.6491 	
start epoch : 5
train   readmit   4   cnn
100%|██████████| 243/243 [02:14<00:00,  1.80it/s]
1 (0.16439379787035308, 0.6996845751166361, 0.13142045927852608)
Avg [0.16439379787035308, 0.6996845751166361, 0.13142045927852608]

train Epoch 5 (lr 0.000100)
loss: 0.6240 	
Running time: 134.91361904144287
valid   readmit   4   cnn
100%|██████████| 35/35 [01:39<00:00,  2.85s/it]
1 (0.15294804436660828, 0.6512430939226519, 0.11468546205639085)
Avg [0.15294804436660828, 0.6512430939226519, 0.11468546205639085]

valid Epoch 5 (lr 0.000100)
loss: 0.6502 	
				 best epoch: 5     best AUC: 0.6512 	
start epoch : 6
train   readmit   4   cnn
100%|██████████| 243/243 [02:03<00:00,  1.97it/s]
1 (0.16680459770114944, 0.7089291761761988, 0.1358782170694669)
Avg [0.16680459770114944, 0.7089291761761988, 0.1358782170694669]

train Epoch 6 (lr 0.000100)
loss: 0.6174 	
Running time: 123.41489696502686
valid   readmit   4   cnn
100%|██████████| 35/35 [01:37<00:00,  2.80s/it]
1 (0.16865671641791047, 0.6579327808471456, 0.11670743286123958)
Avg [0.16865671641791047, 0.6579327808471456, 0.11670743286123958]

valid Epoch 6 (lr 0.000100)
loss: 0.6474 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 7
train   readmit   4   cnn
100%|██████████| 243/243 [02:03<00:00,  1.97it/s]
1 (0.17349674454232095, 0.7114087207743577, 0.1423197612457106)
Avg [0.17349674454232095, 0.7114087207743577, 0.1423197612457106]

train Epoch 7 (lr 0.000100)
loss: 0.6178 	
Running time: 123.53933119773865
valid   readmit   4   cnn
100%|██████████| 35/35 [01:40<00:00,  2.88s/it]
1 (0.16444132115249474, 0.6572268262737876, 0.11781851861930101)
Avg [0.16444132115249474, 0.6572268262737876, 0.11781851861930101]

valid Epoch 7 (lr 0.000100)
loss: 0.6488 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 8
train   readmit   4   cnn
100%|██████████| 243/243 [02:01<00:00,  2.01it/s]
1 (0.1822620016273393, 0.7312271451126274, 0.15927139422221323)
Avg [0.1822620016273393, 0.7312271451126274, 0.15927139422221323]

train Epoch 8 (lr 0.000100)
loss: 0.5988 	
Running time: 121.15264701843262
valid   readmit   4   cnn
100%|██████████| 35/35 [01:37<00:00,  2.80s/it]
1 (0.1531645569620253, 0.6491144874155924, 0.11755500547911696)
Avg [0.1531645569620253, 0.6491144874155924, 0.11755500547911696]

valid Epoch 8 (lr 0.000100)
loss: 0.6559 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 9
train   readmit   4   cnn
100%|██████████| 243/243 [02:01<00:00,  2.01it/s]
1 (0.18461844197138316, 0.7415239300502604, 0.1635015303845187)
Avg [0.18461844197138316, 0.7415239300502604, 0.1635015303845187]

train Epoch 9 (lr 0.000100)
loss: 0.5914 	
Running time: 121.17505502700806
valid   readmit   4   cnn
100%|██████████| 35/35 [01:37<00:00,  2.79s/it]
1 (0.14854111405835543, 0.6516881522406384, 0.12379186195252813)
Avg [0.14854111405835543, 0.6516881522406384, 0.12379186195252813]

valid Epoch 9 (lr 0.000100)
loss: 0.6548 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 10
train   readmit   4   cnn
100%|██████████| 243/243 [02:01<00:00,  2.01it/s]
1 (0.1852823952561485, 0.7494993613566415, 0.17767992087259218)
Avg [0.1852823952561485, 0.7494993613566415, 0.17767992087259218]

train Epoch 10 (lr 0.000100)
loss: 0.5836 	
Running time: 121.20259094238281
valid   readmit   4   cnn
100%|██████████| 35/35 [01:39<00:00,  2.83s/it]
1 (0.16126601356443102, 0.6468646408839779, 0.12057751348743222)
Avg [0.16126601356443102, 0.6468646408839779, 0.12057751348743222]

valid Epoch 10 (lr 0.000100)
loss: 0.6561 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 11
train   readmit   4   cnn
100%|██████████| 243/243 [02:01<00:00,  2.00it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.19784132636029822, 0.7553166928935509, 0.17657593627144366)
Avg [0.19784132636029822, 0.7553166928935509, 0.17657593627144366]

train Epoch 11 (lr 0.000100)
loss: 0.5814 	
Running time: 121.83074474334717
valid   readmit   4   cnn
100%|██████████| 35/35 [01:39<00:00,  2.83s/it]
1 (0.15236051502145925, 0.6516620626151013, 0.12383465825371853)
Avg [0.15236051502145925, 0.6516620626151013, 0.12383465825371853]

valid Epoch 11 (lr 0.000100)
loss: 0.6537 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 12
train   readmit   4   cnn
100%|██████████| 243/243 [02:02<00:00,  1.98it/s]
1 (0.19703389830508475, 0.7637710087272547, 0.17594527381354583)
Avg [0.19703389830508475, 0.7637710087272547, 0.17594527381354583]

train Epoch 12 (lr 0.000100)
loss: 0.5767 	
Running time: 122.90780997276306
valid   readmit   4   cnn
100%|██████████| 35/35 [01:37<00:00,  2.79s/it]
1 (0.15762273901808788, 0.6466114180478821, 0.11903976969977625)
Avg [0.15762273901808788, 0.6466114180478821, 0.11903976969977625]

valid Epoch 12 (lr 0.000100)
loss: 0.6535 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 13
train   readmit   4   cnn
100%|██████████| 243/243 [02:05<00:00,  1.93it/s]
1 (0.19902544667027616, 0.7664137745233561, 0.1869672757331696)
Avg [0.19902544667027616, 0.7664137745233561, 0.1869672757331696]

train Epoch 13 (lr 0.000100)
loss: 0.5676 	
Running time: 125.67980694770813
valid   readmit   4   cnn
100%|██████████| 35/35 [01:37<00:00,  2.80s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.15511163337250294, 0.6443293431553101, 0.11552464647775926)
Avg [0.15511163337250294, 0.6443293431553101, 0.11552464647775926]

valid Epoch 13 (lr 0.000100)
loss: 0.6587 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 14
train   readmit   4   cnn
100%|██████████| 243/243 [02:06<00:00,  1.92it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.19657637321294205, 0.7823715618697512, 0.20063694739760696)
Avg [0.19657637321294205, 0.7823715618697512, 0.20063694739760696]

train Epoch 14 (lr 0.000100)
loss: 0.5612 	
Running time: 126.83775901794434
valid   readmit   4   cnn
100%|██████████| 35/35 [01:38<00:00,  2.82s/it]
1 (0.1573187414500684, 0.6494505831798648, 0.11980563368218188)
Avg [0.1573187414500684, 0.6494505831798648, 0.11980563368218188]

valid Epoch 14 (lr 0.000100)
loss: 0.6554 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 15
train   readmit   4   cnn
100%|██████████| 243/243 [02:01<00:00,  1.99it/s]
1 (0.2039385503660171, 0.782673343068028, 0.20047266399360636)
Avg [0.2039385503660171, 0.782673343068028, 0.20047266399360636]

train Epoch 15 (lr 0.000100)
loss: 0.5579 	
Running time: 122.0193202495575
valid   readmit   4   cnn
100%|██████████| 35/35 [01:39<00:00,  2.83s/it]
1 (0.15256257449344457, 0.6503606507059546, 0.12179393528559188)
Avg [0.15256257449344457, 0.6503606507059546, 0.12179393528559188]

valid Epoch 15 (lr 0.000100)
loss: 0.6568 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 16
train   readmit   4   cnn
100%|██████████| 243/243 [02:11<00:00,  1.85it/s]
1 (0.20814479638009048, 0.792904114389283, 0.2072832389713177)
Avg [0.20814479638009048, 0.792904114389283, 0.2072832389713177]

train Epoch 16 (lr 0.000100)
loss: 0.5475 	
Running time: 131.40006399154663
valid   readmit   4   cnn
100%|██████████| 35/35 [01:38<00:00,  2.80s/it]
1 (0.15086206896551724, 0.6452593615715162, 0.12029753474180942)
Avg [0.15086206896551724, 0.6452593615715162, 0.12029753474180942]

valid Epoch 16 (lr 0.000100)
loss: 0.6615 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 17
train   readmit   4   cnn
100%|██████████| 243/243 [02:02<00:00,  1.98it/s]
1 (0.20760967774319847, 0.7942994155524815, 0.21029802684863766)
Avg [0.20760967774319847, 0.7942994155524815, 0.21029802684863766]

train Epoch 17 (lr 0.000100)
loss: 0.5466 	
Running time: 122.78601598739624
valid   readmit   4   cnn
100%|██████████| 35/35 [01:37<00:00,  2.78s/it]
1 (0.1482277121374866, 0.6427992633517494, 0.1220978168569383)
Avg [0.1482277121374866, 0.6427992633517494, 0.1220978168569383]

valid Epoch 17 (lr 0.000100)
loss: 0.6648 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 18
train   readmit   4   cnn
100%|██████████| 243/243 [02:04<00:00,  1.95it/s]
1 (0.21909730097527785, 0.8004134000651186, 0.22588476121754378)
Avg [0.21909730097527785, 0.8004134000651186, 0.22588476121754378]

train Epoch 18 (lr 0.000100)
loss: 0.5461 	
Running time: 124.87207889556885
valid   readmit   4   cnn
100%|██████████| 35/35 [01:38<00:00,  2.81s/it]
1 (0.1477207155222158, 0.6454435236341315, 0.12647570956623427)
Avg [0.1477207155222158, 0.6454435236341315, 0.12647570956623427]

valid Epoch 18 (lr 0.000100)
loss: 0.6548 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 19
train   readmit   4   cnn
100%|██████████| 243/243 [02:04<00:00,  1.96it/s]
1 (0.22709026264479873, 0.8113890702094823, 0.23526959253828425)
Avg [0.22709026264479873, 0.8113890702094823, 0.23526959253828425]

train Epoch 19 (lr 0.000100)
loss: 0.5307 	
Running time: 124.05369782447815
valid   readmit   4   cnn
100%|██████████| 35/35 [01:38<00:00,  2.81s/it]
1 (0.1505911636589919, 0.6452915899324739, 0.12809572616086407)
Avg [0.1505911636589919, 0.6452915899324739, 0.12809572616086407]

valid Epoch 19 (lr 0.000100)
loss: 0.6613 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 20
train   readmit   4   cnn
100%|██████████| 243/243 [02:05<00:00,  1.93it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.22517436067751576, 0.8150473220617833, 0.24262357481627345)
Avg [0.22517436067751576, 0.8150473220617833, 0.24262357481627345]

train Epoch 20 (lr 0.000100)
loss: 0.5289 	
Running time: 125.90352010726929
valid   readmit   4   cnn
100%|██████████| 35/35 [01:39<00:00,  2.83s/it]
1 (0.14767441860465116, 0.646012891344383, 0.13029277591507799)
Avg [0.14767441860465116, 0.646012891344383, 0.13029277591507799]

valid Epoch 20 (lr 0.000100)
loss: 0.6727 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 21
train   readmit   4   cnn
100%|██████████| 243/243 [02:05<00:00,  1.93it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.2313300927971719, 0.824709546620704, 0.2507628406866716)
Avg [0.2313300927971719, 0.824709546620704, 0.2507628406866716]

train Epoch 21 (lr 0.000100)
loss: 0.5160 	
Running time: 125.966796875
valid   readmit   4   cnn
100%|██████████| 35/35 [01:42<00:00,  2.94s/it]
1 (0.15077605321507762, 0.6497667280540209, 0.1269355597523125)
Avg [0.15077605321507762, 0.6497667280540209, 0.1269355597523125]

valid Epoch 21 (lr 0.000100)
loss: 0.6659 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 22
train   readmit   4   cnn
100%|██████████| 243/243 [02:07<00:00,  1.91it/s]
1 (0.23241450303099623, 0.8223033323386105, 0.27182168061679657)
Avg [0.23241450303099623, 0.8223033323386105, 0.27182168061679657]

train Epoch 22 (lr 0.000100)
loss: 0.5142 	
Running time: 127.44062399864197
valid   readmit   4   cnn
100%|██████████| 35/35 [01:38<00:00,  2.82s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.15175817396668723, 0.6438259668508287, 0.12108133588310441)
Avg [0.15175817396668723, 0.6438259668508287, 0.12108133588310441]

valid Epoch 22 (lr 0.000100)
loss: 0.6671 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 23
train   readmit   4   cnn
100%|██████████| 243/243 [02:01<00:00,  2.00it/s]
1 (0.24410207029369285, 0.8259081461521215, 0.2659697055088592)
Avg [0.24410207029369285, 0.8259081461521215, 0.2659697055088592]

train Epoch 23 (lr 0.000100)
loss: 0.5180 	
Running time: 121.67956924438477
valid   readmit   4   cnn
100%|██████████| 35/35 [01:38<00:00,  2.81s/it]
1 (0.1507430997876858, 0.6462615101289135, 0.12681633098025505)
Avg [0.1507430997876858, 0.6462615101289135, 0.12681633098025505]

valid Epoch 23 (lr 0.000100)
loss: 0.6679 	
				 best epoch: 6     best AUC: 0.6579 	
start epoch : 24
train   readmit   4   cnn
100%|██████████| 243/243 [02:02<00:00,  1.98it/s]
1 (0.24638019617001397, 0.8396734387077454, 0.2956254819595511)
Avg [0.24638019617001397, 0.8396734387077454, 0.2956254819595511]

train Epoch 24 (lr 0.000100)
loss: 0.4951 	
Running time: 122.5407178401947
valid   readmit   4   cnn
100%|██████████| 35/35 [01:36<00:00,  2.77s/it]
1 (0.15011037527593818, 0.644243400859423, 0.12552051318641871)
Avg [0.15011037527593818, 0.644243400859423, 0.12552051318641871]

valid Epoch 24 (lr 0.000100)
loss: 0.6673 	
				 best epoch: 6     best AUC: 0.6579 	
best metric [0.6579327808471456, 6]

Process finished with exit code 0