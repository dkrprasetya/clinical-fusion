/Users/luis/opt/anaconda3/envs/CS598FinalProject/bin/python /Users/luis/PycharmProjects/clinical-fusion/main.py 
Use the last 24 collections data
Use the last 24 collections data
Use the last 24 collections data
start epoch : 0
train
100%|██████████| 243/243 [02:29<00:00,  1.62it/s]
1 (0.2416298404613887, 0.6591475227622062, 0.17091713669485692)
Avg [0.2416298404613887, 0.6591475227622062, 0.17091713669485692]

train Epoch 0 (lr 0.000100)
loss: 0.6664 	
Running time: 149.81608390808105
valid
100%|██████████| 35/35 [02:15<00:00,  3.88s/it]
1 (0.2887077997671711, 0.7841775828225774, 0.313322632022956)
Avg [0.2887077997671711, 0.7841775828225774, 0.313322632022956]

valid Epoch 0 (lr 0.000100)
loss: 0.5699 	
				 best epoch: 0     best AUC: 0.7842 	
start epoch : 1
train
100%|██████████| 243/243 [03:19<00:00,  1.22it/s]
1 (0.33535917106705193, 0.7748979648948174, 0.2941752714760881)
Avg [0.33535917106705193, 0.7748979648948174, 0.2941752714760881]

train Epoch 1 (lr 0.000100)
loss: 0.5653 	
Running time: 199.459214925766
valid
100%|██████████| 35/35 [01:44<00:00,  2.98s/it]
1 (0.33043478260869563, 0.8008923206345391, 0.3435890098675578)
Avg [0.33043478260869563, 0.8008923206345391, 0.3435890098675578]

valid Epoch 1 (lr 0.000100)
loss: 0.5480 	
				 best epoch: 1     best AUC: 0.8009 	
start epoch : 2
train
100%|██████████| 243/243 [02:15<00:00,  1.80it/s]
1 (0.3510934393638171, 0.7967741963057273, 0.3279632194622529)
Avg [0.3510934393638171, 0.7967741963057273, 0.3279632194622529]

train Epoch 2 (lr 0.000100)
loss: 0.5398 	
Running time: 135.05766415596008
valid
100%|██████████| 35/35 [01:46<00:00,  3.03s/it]
1 (0.32907991940899933, 0.8098155269799302, 0.36929775438232665)
Avg [0.32907991940899933, 0.8098155269799302, 0.36929775438232665]

valid Epoch 2 (lr 0.000100)
loss: 0.5354 	
				 best epoch: 2     best AUC: 0.8098 	
start epoch : 3
train
100%|██████████| 243/243 [02:26<00:00,  1.66it/s]
1 (0.3588916302903777, 0.815114797646216, 0.3570292757302788)
Avg [0.3588916302903777, 0.815114797646216, 0.3570292757302788]

train Epoch 3 (lr 0.000100)
loss: 0.5196 	
Running time: 146.71922516822815
valid
100%|██████████| 35/35 [02:06<00:00,  3.62s/it]
1 (0.32950708980418636, 0.8133657813564074, 0.3775455820346799)
Avg [0.32950708980418636, 0.8133657813564074, 0.3775455820346799]

valid Epoch 3 (lr 0.000100)
loss: 0.5287 	
				 best epoch: 3     best AUC: 0.8134 	
start epoch : 4
train
100%|██████████| 243/243 [02:23<00:00,  1.69it/s]
1 (0.36170822585267987, 0.8201142214160574, 0.3661269182533093)
Avg [0.36170822585267987, 0.8201142214160574, 0.3661269182533093]

train Epoch 4 (lr 0.000100)
loss: 0.5138 	
Running time: 143.4682810306549
valid
100%|██████████| 35/35 [01:48<00:00,  3.09s/it]
1 (0.33400402414486924, 0.8160878099587391, 0.3797271510184587)
Avg [0.33400402414486924, 0.8160878099587391, 0.3797271510184587]

valid Epoch 4 (lr 0.000100)
loss: 0.5267 	
				 best epoch: 4     best AUC: 0.8161 	
start epoch : 5
train
100%|██████████| 243/243 [02:20<00:00,  1.72it/s]
1 (0.3706230560850807, 0.8208113093930051, 0.372411421220122)
Avg [0.3706230560850807, 0.8208113093930051, 0.372411421220122]

train Epoch 5 (lr 0.000100)
loss: 0.5119 	
Running time: 140.93618488311768
valid
100%|██████████| 35/35 [01:47<00:00,  3.07s/it]
1 (0.3467446964155084, 0.8174057605255779, 0.3771907317915464)
Avg [0.3467446964155084, 0.8174057605255779, 0.3771907317915464]

valid Epoch 5 (lr 0.000100)
loss: 0.5228 	
				 best epoch: 5     best AUC: 0.8174 	
start epoch : 6
train
100%|██████████| 243/243 [02:08<00:00,  1.89it/s]
1 (0.3638630478565264, 0.8271039341189612, 0.37592245304296)
Avg [0.3638630478565264, 0.8271039341189612, 0.37592245304296]

train Epoch 6 (lr 0.000100)
loss: 0.5046 	
Running time: 128.90229487419128
valid
100%|██████████| 35/35 [01:44<00:00,  2.99s/it]
1 (0.3482733284349742, 0.8180777550775147, 0.38408059361300295)
Avg [0.3482733284349742, 0.8180777550775147, 0.38408059361300295]

valid Epoch 6 (lr 0.000100)
loss: 0.5244 	
				 best epoch: 6     best AUC: 0.8181 	
start epoch : 7
train
100%|██████████| 243/243 [02:13<00:00,  1.82it/s]
1 (0.36688040144967937, 0.8338328938486678, 0.39783143240191005)
Avg [0.36688040144967937, 0.8338328938486678, 0.39783143240191005]

train Epoch 7 (lr 0.000100)
loss: 0.4948 	
Running time: 133.81433296203613
valid
100%|██████████| 35/35 [02:01<00:00,  3.46s/it]
1 (0.34195402298850575, 0.8163001241837919, 0.3775414120373812)
Avg [0.34195402298850575, 0.8163001241837919, 0.3775414120373812]

valid Epoch 7 (lr 0.000100)
loss: 0.5226 	
				 best epoch: 6     best AUC: 0.8181 	
start epoch : 8
train
100%|██████████| 243/243 [02:08<00:00,  1.89it/s]
1 (0.3744346116027531, 0.8343540653177047, 0.3969121721717759)
Avg [0.3744346116027531, 0.8343540653177047, 0.3969121721717759]

train Epoch 8 (lr 0.000100)
loss: 0.4971 	
Running time: 128.41306972503662
valid
100%|██████████| 35/35 [01:49<00:00,  3.14s/it]
1 (0.35079726651480636, 0.8175049072627488, 0.38038743835139105)
Avg [0.35079726651480636, 0.8175049072627488, 0.38038743835139105]

valid Epoch 8 (lr 0.000100)
loss: 0.5210 	
				 best epoch: 6     best AUC: 0.8181 	
start epoch : 9
train
100%|██████████| 243/243 [02:09<00:00,  1.87it/s]
1 (0.38618124877666865, 0.8440568446498731, 0.412128214379888)
Avg [0.38618124877666865, 0.8440568446498731, 0.412128214379888]

train Epoch 9 (lr 0.000100)
loss: 0.4857 	
Running time: 129.77999997138977
valid
100%|██████████| 35/35 [01:41<00:00,  2.89s/it]
1 (0.339622641509434, 0.8182770500340503, 0.38420059886920616)
Avg [0.339622641509434, 0.8182770500340503, 0.38420059886920616]

valid Epoch 9 (lr 0.000100)
loss: 0.5227 	
				 best epoch: 9     best AUC: 0.8183 	
start epoch : 10
train
100%|██████████| 243/243 [02:20<00:00,  1.73it/s]
1 (0.41241241241241244, 0.8473828689096645, 0.41870019069251324)
Avg [0.41241241241241244, 0.8473828689096645, 0.41870019069251324]

train Epoch 10 (lr 0.000100)
loss: 0.4792 	
Running time: 140.42533469200134
valid
100%|██████████| 35/35 [01:45<00:00,  3.02s/it]
1 (0.34089246525237743, 0.8163401834715379, 0.37897527140976167)
Avg [0.34089246525237743, 0.8163401834715379, 0.37897527140976167]

valid Epoch 10 (lr 0.000100)
loss: 0.5223 	
				 best epoch: 9     best AUC: 0.8183 	
start epoch : 11
train
100%|██████████| 243/243 [02:08<00:00,  1.90it/s]
1 (0.3886155330438978, 0.8533202600999991, 0.43047664293138416)
Avg [0.3886155330438978, 0.8533202600999991, 0.43047664293138416]

train Epoch 11 (lr 0.000100)
loss: 0.4703 	
Running time: 128.0815987586975
valid
100%|██████████| 35/35 [02:05<00:00,  3.57s/it]
1 (0.35179640718562877, 0.8174828746544887, 0.3793397645575963)
Avg [0.35179640718562877, 0.8174828746544887, 0.3793397645575963]

valid Epoch 11 (lr 0.000100)
loss: 0.5245 	
				 best epoch: 9     best AUC: 0.8183 	
start epoch : 12
train
100%|██████████| 243/243 [02:05<00:00,  1.93it/s]
1 (0.3925543319364584, 0.8570140793783895, 0.4430423205819496)
Avg [0.3925543319364584, 0.8570140793783895, 0.4430423205819496]

train Epoch 12 (lr 0.000100)
loss: 0.4646 	
Running time: 125.64045000076294
valid
100%|██████████| 35/35 [01:45<00:00,  3.01s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.34662799129804206, 0.8208118014661699, 0.38773513580256946)
Avg [0.34662799129804206, 0.8208118014661699, 0.38773513580256946]

valid Epoch 12 (lr 0.000100)
loss: 0.5173 	
				 best epoch: 12     best AUC: 0.8208 	
start epoch : 13
train
100%|██████████| 243/243 [02:09<00:00,  1.87it/s]
1 (0.4009258327463017, 0.8563555584989563, 0.44678867119465504)
Avg [0.4009258327463017, 0.8563555584989563, 0.44678867119465504]

train Epoch 13 (lr 0.000100)
loss: 0.4680 	
Running time: 129.64436316490173
valid
100%|██████████| 35/35 [01:59<00:00,  3.40s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.35649546827794565, 0.821146296518848, 0.3861177228769034)
Avg [0.35649546827794565, 0.821146296518848, 0.3861177228769034]

valid Epoch 13 (lr 0.000100)
loss: 0.5162 	
				 best epoch: 13     best AUC: 0.8211 	
start epoch : 14
train
100%|██████████| 243/243 [02:13<00:00,  1.82it/s]
1 (0.4182110337439743, 0.862077611308397, 0.4487805940208245)
Avg [0.4182110337439743, 0.862077611308397, 0.4487805940208245]

train Epoch 14 (lr 0.000100)
loss: 0.4561 	
Running time: 133.38039088249207
valid
100%|██████████| 35/35 [01:43<00:00,  2.96s/it]
1 (0.35535976505139505, 0.8224261907623283, 0.3895880416981192)
Avg [0.35535976505139505, 0.8224261907623283, 0.3895880416981192]

valid Epoch 14 (lr 0.000100)
loss: 0.5159 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 15
train
100%|██████████| 243/243 [02:14<00:00,  1.80it/s]
1 (0.4282877316857899, 0.8636443125414405, 0.4466087573403209)
Avg [0.4282877316857899, 0.8636443125414405, 0.4466087573403209]

train Epoch 15 (lr 0.000100)
loss: 0.4554 	
Running time: 134.68146085739136
valid
100%|██████████| 35/35 [01:44<00:00,  2.97s/it]
1 (0.344683808200139, 0.8199054600809198, 0.38533519385991555)
Avg [0.344683808200139, 0.8199054600809198, 0.38533519385991555]

valid Epoch 15 (lr 0.000100)
loss: 0.5165 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 16
train
100%|██████████| 243/243 [02:13<00:00,  1.82it/s]
1 (0.423208900904648, 0.8713458302250168, 0.45673860976619163)
Avg [0.423208900904648, 0.8713458302250168, 0.45673860976619163]

train Epoch 16 (lr 0.000100)
loss: 0.4501 	
Running time: 133.836088180542
valid
100%|██████████| 35/35 [01:43<00:00,  2.96s/it]
1 (0.34795111430625447, 0.819077234306774, 0.375379342973971)
Avg [0.34795111430625447, 0.819077234306774, 0.375379342973971]

valid Epoch 16 (lr 0.000100)
loss: 0.5180 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 17
train
100%|██████████| 243/243 [02:09<00:00,  1.87it/s]
1 (0.4297716501507971, 0.8743305760878197, 0.4737441846169337)
Avg [0.4297716501507971, 0.8743305760878197, 0.4737441846169337]

train Epoch 17 (lr 0.000100)
loss: 0.4431 	
Running time: 129.65262484550476
valid
100%|██████████| 35/35 [02:03<00:00,  3.54s/it]
1 (0.3394185260311021, 0.8203240796378641, 0.38141099270400086)
Avg [0.3394185260311021, 0.8203240796378641, 0.38141099270400086]

valid Epoch 17 (lr 0.000100)
loss: 0.5172 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 18
train
100%|██████████| 243/243 [02:08<00:00,  1.90it/s]
1 (0.42647845150251307, 0.874262333415875, 0.475168509938222)
Avg [0.42647845150251307, 0.874262333415875, 0.475168509938222]

train Epoch 18 (lr 0.000100)
loss: 0.4399 	
Running time: 128.2257740497589
valid
100%|██████████| 35/35 [01:51<00:00,  3.17s/it]
1 (0.3409881697981907, 0.8201878780595282, 0.38690005366898195)
Avg [0.3409881697981907, 0.8201878780595282, 0.38690005366898195]

valid Epoch 18 (lr 0.000100)
loss: 0.5185 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 19
train
100%|██████████| 243/243 [02:10<00:00,  1.86it/s]
1 (0.442088819459942, 0.8797590135237001, 0.48579252029936293)
Avg [0.442088819459942, 0.8797590135237001, 0.48579252029936293]

train Epoch 19 (lr 0.000100)
loss: 0.4315 	
Running time: 130.57094407081604
valid
100%|██████████| 35/35 [02:05<00:00,  3.59s/it]
1 (0.33783783783783783, 0.8211623202339462, 0.3869980186335269)
Avg [0.33783783783783783, 0.8211623202339462, 0.3869980186335269]

valid Epoch 19 (lr 0.000100)
loss: 0.5238 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 20
train
100%|██████████| 243/243 [02:08<00:00,  1.88it/s]
1 (0.4250821018062398, 0.8805727783521496, 0.4895821025044936)
Avg [0.4250821018062398, 0.8805727783521496, 0.4895821025044936]

train Epoch 20 (lr 0.000100)
loss: 0.4314 	
Running time: 128.97679805755615
valid
100%|██████████| 35/35 [01:43<00:00,  2.95s/it]
1 (0.34293745607870696, 0.8200176260866081, 0.38608782532027835)
Avg [0.34293745607870696, 0.8200176260866081, 0.38608782532027835]

valid Epoch 20 (lr 0.000100)
loss: 0.5207 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 21
train
100%|██████████| 243/243 [02:16<00:00,  1.78it/s]
1 (0.4344426835710512, 0.8845207075117779, 0.5061375686631394)
Avg [0.4344426835710512, 0.8845207075117779, 0.5061375686631394]

train Epoch 21 (lr 0.000100)
loss: 0.4250 	
Running time: 136.48694896697998
valid
100%|██████████| 35/35 [01:43<00:00,  2.94s/it]
1 (0.34855938158819394, 0.8191783840083323, 0.37928315316519)
Avg [0.34855938158819394, 0.8191783840083323, 0.37928315316519]

valid Epoch 21 (lr 0.000100)
loss: 0.5239 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 22
train
100%|██████████| 243/243 [02:25<00:00,  1.67it/s]
1 (0.43034341363403383, 0.8864057847338662, 0.507193987624666)
Avg [0.43034341363403383, 0.8864057847338662, 0.507193987624666]

train Epoch 22 (lr 0.000100)
loss: 0.4212 	
Running time: 145.1914873123169
valid
100%|██████████| 35/35 [01:42<00:00,  2.93s/it]
1 (0.3433777154870358, 0.8168279052998437, 0.383292576102591)
Avg [0.3433777154870358, 0.8168279052998437, 0.383292576102591]

valid Epoch 22 (lr 0.000100)
loss: 0.5242 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 23
train
100%|██████████| 243/243 [02:07<00:00,  1.91it/s]
1 (0.44355349229795316, 0.8900880831255021, 0.5141296515667164)
Avg [0.44355349229795316, 0.8900880831255021, 0.5141296515667164]

train Epoch 23 (lr 0.000100)
loss: 0.4183 	
Running time: 127.41926288604736
valid
100%|██████████| 35/35 [01:43<00:00,  2.97s/it]
1 (0.3400416377515615, 0.8185083924207829, 0.38347896242202667)
Avg [0.3400416377515615, 0.8185083924207829, 0.38347896242202667]

valid Epoch 23 (lr 0.000100)
loss: 0.5262 	
				 best epoch: 14     best AUC: 0.8224 	
start epoch : 24
train
100%|██████████| 243/243 [02:07<00:00,  1.90it/s]
1 (0.44270343674919044, 0.894957070017, 0.5271814189442556)
Avg [0.44270343674919044, 0.894957070017, 0.5271814189442556]

train Epoch 24 (lr 0.000100)
loss: 0.4064 	
Running time: 127.86389374732971
valid
100%|██████████| 35/35 [01:41<00:00,  2.89s/it]
1 (0.3400696864111498, 0.817745262989224, 0.38706702392127434)
Avg [0.3400696864111498, 0.817745262989224, 0.38706702392127434]

valid Epoch 24 (lr 0.000100)
loss: 0.5247 	
				 best epoch: 14     best AUC: 0.8224 	
best metric [0.8224261907623283, 14]

Process finished with exit code 0