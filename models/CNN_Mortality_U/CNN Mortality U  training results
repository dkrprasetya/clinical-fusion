/Users/luis/opt/anaconda3/envs/CS598FinalProject/bin/python /Users/luis/PycharmProjects/clinical-fusion/main.py 
Use the last 24 collections data
Use the last 24 collections data
Use the last 24 collections data
start epoch : 0
train   mortality   4   cnn
100%|██████████| 243/243 [03:37<00:00,  1.12it/s]
1 (0.26322458029775103, 0.6940342915849472, 0.217531326239322)
Avg [0.26322458029775103, 0.6940342915849472, 0.217531326239322]

train Epoch 0 (lr 0.000100)
loss: 0.6365 	
Running time: 217.67210388183594
valid   mortality   4   cnn
100%|██████████| 35/35 [02:26<00:00,  4.18s/it]
1 (0.31280276816608993, 0.7842506910227136, 0.29847967188562124)
Avg [0.31280276816608993, 0.7842506910227136, 0.29847967188562124]

valid Epoch 0 (lr 0.000100)
loss: 0.5699 	
				 best epoch: 0     best AUC: 0.7843 	
start epoch : 1
train   mortality   4   cnn
100%|██████████| 243/243 [05:08<00:00,  1.27s/it]
1 (0.32770605759682225, 0.7778026127215638, 0.2976714207627939)
Avg [0.32770605759682225, 0.7778026127215638, 0.2976714207627939]

train Epoch 1 (lr 0.000100)
loss: 0.5611 	
Running time: 308.43842792510986
valid   mortality   4   cnn
100%|██████████| 35/35 [01:51<00:00,  3.17s/it]
1 (0.3375653472740851, 0.8009574169771262, 0.32462674709500283)
Avg [0.3375653472740851, 0.8009574169771262, 0.32462674709500283]

valid Epoch 1 (lr 0.000100)
loss: 0.5487 	
				 best epoch: 1     best AUC: 0.8010 	
start epoch : 2
train   mortality   4   cnn
100%|██████████| 243/243 [02:19<00:00,  1.75it/s]
1 (0.34459772243310804, 0.8010951141740318, 0.3363068929788826)
Avg [0.34459772243310804, 0.8010951141740318, 0.3363068929788826]

train Epoch 2 (lr 0.000100)
loss: 0.5386 	
Running time: 139.22714185714722
valid   mortality   4   cnn
100%|██████████| 35/35 [01:52<00:00,  3.21s/it]
1 (0.3446244477172312, 0.8120928974882826, 0.3449218996577116)
Avg [0.3446244477172312, 0.8120928974882826, 0.3449218996577116]

valid Epoch 2 (lr 0.000100)
loss: 0.5360 	
				 best epoch: 2     best AUC: 0.8121 	
start epoch : 3
train   mortality   4   cnn
100%|██████████| 243/243 [03:47<00:00,  1.07it/s]
1 (0.3640502820944274, 0.8142332082425181, 0.3572214415747136)
Avg [0.3640502820944274, 0.8142332082425181, 0.3572214415747136]

train Epoch 3 (lr 0.000100)
loss: 0.5212 	
Running time: 227.11777997016907
valid   mortality   4   cnn
100%|██████████| 35/35 [01:51<00:00,  3.19s/it]
1 (0.3358992302309307, 0.8139726795657574, 0.3520184029566243)
Avg [0.3358992302309307, 0.8139726795657574, 0.3520184029566243]

valid Epoch 3 (lr 0.000100)
loss: 0.5286 	
				 best epoch: 3     best AUC: 0.8140 	
start epoch : 4
train   mortality   4   cnn
100%|██████████| 243/243 [02:34<00:00,  1.58it/s]
1 (0.366262276140959, 0.8246250295129812, 0.3736245198867759)
Avg [0.366262276140959, 0.8246250295129812, 0.3736245198867759]

train Epoch 4 (lr 0.000100)
loss: 0.5069 	
Running time: 154.31707286834717
valid   mortality   4   cnn
100%|██████████| 35/35 [01:46<00:00,  3.05s/it]
1 (0.3567567567567567, 0.81762608660818, 0.3565027577908843)
Avg [0.3567567567567567, 0.81762608660818, 0.3565027577908843]

valid Epoch 4 (lr 0.000100)
loss: 0.5274 	
				 best epoch: 4     best AUC: 0.8176 	
start epoch : 5
train   mortality   4   cnn
100%|██████████| 243/243 [02:55<00:00,  1.38it/s]
1 (0.3550646551724138, 0.8256905814632426, 0.38691842408074945)
Avg [0.3550646551724138, 0.8256905814632426, 0.38691842408074945]

train Epoch 5 (lr 0.000100)
loss: 0.5050 	
Running time: 175.72386288642883
valid   mortality   4   cnn
100%|██████████| 35/35 [02:02<00:00,  3.51s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.3405698778833107, 0.8180407002363498, 0.3618862084778273)
Avg [0.3405698778833107, 0.8180407002363498, 0.3618862084778273]

valid Epoch 5 (lr 0.000100)
loss: 0.5225 	
				 best epoch: 5     best AUC: 0.8180 	
start epoch : 6
train   mortality   4   cnn
100%|██████████| 243/243 [03:20<00:00,  1.21it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.38660951214533573, 0.8329442804204648, 0.38722126804881496)
Avg [0.38660951214533573, 0.8329442804204648, 0.38722126804881496]

train Epoch 6 (lr 0.000100)
loss: 0.5007 	
Running time: 200.40512990951538
valid   mortality   4   cnn
100%|██████████| 35/35 [01:59<00:00,  3.41s/it]
1 (0.3335548172757475, 0.8195469294555944, 0.3628039527161038)
Avg [0.3335548172757475, 0.8195469294555944, 0.3628039527161038]

valid Epoch 6 (lr 0.000100)
loss: 0.5221 	
				 best epoch: 6     best AUC: 0.8195 	
start epoch : 7
train   mortality   4   cnn
100%|██████████| 243/243 [03:04<00:00,  1.32it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.3721233578682568, 0.8385468690670919, 0.40499785484127626)
Avg [0.3721233578682568, 0.8385468690670919, 0.40499785484127626]

train Epoch 7 (lr 0.000100)
loss: 0.4928 	
Running time: 184.07437324523926
valid   mortality   4   cnn
100%|██████████| 35/35 [01:42<00:00,  2.94s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.3462350457424349, 0.8201037535552619, 0.369319272380035)
Avg [0.3462350457424349, 0.8201037535552619, 0.369319272380035]

valid Epoch 7 (lr 0.000100)
loss: 0.5207 	
				 best epoch: 7     best AUC: 0.8201 	
start epoch : 8
train   mortality   4   cnn
100%|██████████| 243/243 [02:26<00:00,  1.65it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.3825343147006167, 0.8393875128676227, 0.41254011853549466)
Avg [0.3825343147006167, 0.8393875128676227, 0.41254011853549466]

train Epoch 8 (lr 0.000100)
loss: 0.4897 	
Running time: 147.0249149799347
valid   mortality   4   cnn
100%|██████████| 35/35 [01:49<00:00,  3.13s/it]
1 (0.33376623376623377, 0.8208698874334014, 0.36990612157000624)
Avg [0.33376623376623377, 0.8208698874334014, 0.36990612157000624]

valid Epoch 8 (lr 0.000100)
loss: 0.5194 	
				 best epoch: 8     best AUC: 0.8209 	
start epoch : 9
train   mortality   4   cnn
100%|██████████| 243/243 [02:14<00:00,  1.80it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.3815977856256562, 0.8440577644626058, 0.4121146702929082)
Avg [0.3815977856256562, 0.8440577644626058, 0.4121146702929082]

train Epoch 9 (lr 0.000100)
loss: 0.4842 	
Running time: 134.9204752445221
valid   mortality   4   cnn
100%|██████████| 35/35 [01:56<00:00,  3.32s/it]
1 (0.3356449375866851, 0.8189700757120538, 0.3669158987475308)
Avg [0.3356449375866851, 0.8189700757120538, 0.3669158987475308]

valid Epoch 9 (lr 0.000100)
loss: 0.5212 	
				 best epoch: 8     best AUC: 0.8209 	
start epoch : 10
train   mortality   4   cnn
100%|██████████| 243/243 [03:56<00:00,  1.03it/s]
1 (0.39710676446617765, 0.8525963024420081, 0.43542578716529134)
Avg [0.39710676446617765, 0.8525963024420081, 0.43542578716529134]

train Epoch 10 (lr 0.000100)
loss: 0.4715 	
Running time: 236.65265703201294
valid   mortality   4   cnn
100%|██████████| 35/35 [01:46<00:00,  3.05s/it]
1 (0.3449691991786447, 0.8204372471257461, 0.3714354789961506)
Avg [0.3449691991786447, 0.8204372471257461, 0.3714354789961506]

valid Epoch 10 (lr 0.000100)
loss: 0.5202 	
				 best epoch: 8     best AUC: 0.8209 	
start epoch : 11
train   mortality   4   cnn
100%|██████████| 243/243 [02:33<00:00,  1.59it/s]
1 (0.3949787486409014, 0.854034006907552, 0.43610974741160535)
Avg [0.3949787486409014, 0.854034006907552, 0.43610974741160535]

train Epoch 11 (lr 0.000100)
loss: 0.4686 	
Running time: 153.15151715278625
valid   mortality   4   cnn
100%|██████████| 35/35 [01:50<00:00,  3.15s/it]
1 (0.34317089910775567, 0.8208959259704363, 0.3717276729527861)
Avg [0.34317089910775567, 0.8208959259704363, 0.3717276729527861]

valid Epoch 11 (lr 0.000100)
loss: 0.5223 	
				 best epoch: 11     best AUC: 0.8209 	
start epoch : 12
train   mortality   4   cnn
100%|██████████| 243/243 [03:03<00:00,  1.32it/s]
1 (0.4085213032581454, 0.8551367973369359, 0.4352089551971413)
Avg [0.4085213032581454, 0.8551367973369359, 0.4352089551971413]

train Epoch 12 (lr 0.000100)
loss: 0.4676 	
Running time: 183.6850950717926
valid   mortality   4   cnn
100%|██████████| 35/35 [01:49<00:00,  3.12s/it]
1 (0.3367556468172484, 0.820029643872932, 0.3722950930135519)
Avg [0.3367556468172484, 0.820029643872932, 0.3722950930135519]

valid Epoch 12 (lr 0.000100)
loss: 0.5186 	
				 best epoch: 11     best AUC: 0.8209 	
start epoch : 13
train   mortality   4   cnn
100%|██████████| 243/243 [02:18<00:00,  1.76it/s]
1 (0.41464452958705833, 0.8614259750879034, 0.45235262421049494)
Avg [0.41464452958705833, 0.8614259750879034, 0.45235262421049494]

train Epoch 13 (lr 0.000100)
loss: 0.4595 	
Running time: 138.0824203491211
valid   mortality   4   cnn
100%|██████████| 35/35 [01:48<00:00,  3.11s/it]
1 (0.33893745796906527, 0.8171834314785884, 0.3716918821128512)
Avg [0.33893745796906527, 0.8171834314785884, 0.3716918821128512]

valid Epoch 13 (lr 0.000100)
loss: 0.5216 	
				 best epoch: 11     best AUC: 0.8209 	
start epoch : 14
train   mortality   4   cnn
100%|██████████| 243/243 [02:26<00:00,  1.66it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.4106162294081757, 0.8671742843698991, 0.45996745637885605)
Avg [0.4106162294081757, 0.8671742843698991, 0.45996745637885605]

train Epoch 14 (lr 0.000100)
loss: 0.4524 	
Running time: 146.27854895591736
valid   mortality   4   cnn
100%|██████████| 35/35 [01:50<00:00,  3.16s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.352081811541271, 0.8208007851620398, 0.3740516302096312)
Avg [0.352081811541271, 0.8208007851620398, 0.3740516302096312]

valid Epoch 14 (lr 0.000100)
loss: 0.5184 	
				 best epoch: 11     best AUC: 0.8209 	
start epoch : 15
train   mortality   4   cnn
100%|██████████| 243/243 [02:29<00:00,  1.63it/s]
1 (0.40218344867920847, 0.8656690433512757, 0.45937750906408703)
Avg [0.40218344867920847, 0.8656690433512757, 0.45937750906408703]

train Epoch 15 (lr 0.000100)
loss: 0.4528 	
Running time: 149.57714200019836
valid   mortality   4   cnn
100%|██████████| 35/35 [01:52<00:00,  3.22s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.3440559440559441, 0.8187227096102231, 0.36964673964009276)
Avg [0.3440559440559441, 0.8187227096102231, 0.36964673964009276]

valid Epoch 15 (lr 0.000100)
loss: 0.5215 	
				 best epoch: 11     best AUC: 0.8209 	
start epoch : 16
train   mortality   4   cnn
100%|██████████| 243/243 [02:30<00:00,  1.61it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.41299208551752487, 0.8685738026704747, 0.46397153178597084)
Avg [0.41299208551752487, 0.8685738026704747, 0.46397153178597084]

train Epoch 16 (lr 0.000100)
loss: 0.4485 	
Running time: 150.55645489692688
valid   mortality   4   cnn
100%|██████████| 35/35 [02:32<00:00,  4.37s/it]
1 (0.33813892529488865, 0.8175750110163043, 0.36810721841506755)
Avg [0.33813892529488865, 0.8175750110163043, 0.36810721841506755]

valid Epoch 16 (lr 0.000100)
loss: 0.5259 	
				 best epoch: 11     best AUC: 0.8209 	
start epoch : 17
train   mortality   4   cnn
100%|██████████| 243/243 [03:24<00:00,  1.19it/s]
1 (0.4220577191288489, 0.8678919612864014, 0.4623085233891026)
Avg [0.4220577191288489, 0.8678919612864014, 0.4623085233891026]

train Epoch 17 (lr 0.000100)
loss: 0.4490 	
Running time: 204.63967084884644
valid   mortality   4   cnn
100%|██████████| 35/35 [01:45<00:00,  3.02s/it]
1 (0.34537572254335264, 0.8206435524576372, 0.3712635302576334)
Avg [0.34537572254335264, 0.8206435524576372, 0.3712635302576334]

valid Epoch 17 (lr 0.000100)
loss: 0.5184 	
				 best epoch: 11     best AUC: 0.8209 	
start epoch : 18
train   mortality   4   cnn
100%|██████████| 243/243 [02:15<00:00,  1.79it/s]
1 (0.41649027315794784, 0.8763494907080518, 0.48964582254684813)
Avg [0.41649027315794784, 0.8763494907080518, 0.48964582254684813]

train Epoch 18 (lr 0.000100)
loss: 0.4370 	
Running time: 135.73989701271057
valid   mortality   4   cnn
100%|██████████| 35/35 [01:47<00:00,  3.07s/it]
1 (0.3398516520566419, 0.8209960741898009, 0.3704401300910704)
Avg [0.3398516520566419, 0.8209960741898009, 0.3704401300910704]

valid Epoch 18 (lr 0.000100)
loss: 0.5202 	
				 best epoch: 18     best AUC: 0.8210 	
start epoch : 19
train   mortality   4   cnn
100%|██████████| 243/243 [03:19<00:00,  1.22it/s]
1 (0.4261988789703135, 0.8774755551868871, 0.4900662416497379)
Avg [0.4261988789703135, 0.8774755551868871, 0.4900662416497379]

train Epoch 19 (lr 0.000100)
loss: 0.4330 	
Running time: 199.9731798171997
valid   mortality   4   cnn
100%|██████████| 35/35 [01:45<00:00,  3.02s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.34355828220858897, 0.819524896847334, 0.3675821093859559)
Avg [0.34355828220858897, 0.819524896847334, 0.3675821093859559]

valid Epoch 19 (lr 0.000100)
loss: 0.5210 	
				 best epoch: 18     best AUC: 0.8210 	
start epoch : 20
train   mortality   4   cnn
100%|██████████| 243/243 [02:15<00:00,  1.80it/s]
1 (0.43890381515314353, 0.8812205030457695, 0.490478124354389)
Avg [0.43890381515314353, 0.8812205030457695, 0.490478124354389]

train Epoch 20 (lr 0.000100)
loss: 0.4292 	
Running time: 135.1281440258026
valid   mortality   4   cnn
100%|██████████| 35/35 [01:48<00:00,  3.09s/it]
1 (0.34265734265734266, 0.8176711533068943, 0.36730981821727715)
Avg [0.34265734265734266, 0.8176711533068943, 0.36730981821727715]

valid Epoch 20 (lr 0.000100)
loss: 0.5224 	
				 best epoch: 18     best AUC: 0.8210 	
start epoch : 21
train   mortality   4   cnn
100%|██████████| 243/243 [03:13<00:00,  1.26it/s]
1 (0.44466040384407735, 0.8849866716347703, 0.5104969698967945)
Avg [0.44466040384407735, 0.8849866716347703, 0.5104969698967945]

train Epoch 21 (lr 0.000100)
loss: 0.4233 	
Running time: 193.3749930858612
valid   mortality   4   cnn
100%|██████████| 35/35 [02:08<00:00,  3.67s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.345821325648415, 0.8184883627769098, 0.3675159443954803)
Avg [0.345821325648415, 0.8184883627769098, 0.3675159443954803]

valid Epoch 21 (lr 0.000100)
loss: 0.5232 	
				 best epoch: 18     best AUC: 0.8210 	
start epoch : 22
train   mortality   4   cnn
100%|██████████| 243/243 [02:19<00:00,  1.74it/s]
1 (0.45626772546795225, 0.8892184605783686, 0.5127997239152671)
Avg [0.45626772546795225, 0.8892184605783686, 0.5127997239152671]

train Epoch 22 (lr 0.000100)
loss: 0.4139 	
Running time: 139.43750715255737
valid   mortality   4   cnn
100%|██████████| 35/35 [01:47<00:00,  3.08s/it]
1 (0.3389830508474576, 0.8199465208508592, 0.37688796409991704)
Avg [0.3389830508474576, 0.8199465208508592, 0.37688796409991704]

valid Epoch 22 (lr 0.000100)
loss: 0.5250 	
				 best epoch: 18     best AUC: 0.8210 	
start epoch : 23
train   mortality   4   cnn
100%|██████████| 243/243 [02:28<00:00,  1.63it/s]
1 (0.43968169761273207, 0.8886863628489905, 0.5296554840460986)
Avg [0.43968169761273207, 0.8886863628489905, 0.5296554840460986]

train Epoch 23 (lr 0.000100)
loss: 0.4157 	
Running time: 148.8579499721527
valid   mortality   4   cnn
100%|██████████| 35/35 [01:48<00:00,  3.11s/it]
1 (0.34112792297111416, 0.8191022713616152, 0.3705240093336127)
Avg [0.34112792297111416, 0.8191022713616152, 0.3705240093336127]

valid Epoch 23 (lr 0.000100)
loss: 0.5228 	
				 best epoch: 18     best AUC: 0.8210 	
start epoch : 24
train   mortality   4   cnn
100%|██████████| 243/243 [03:11<00:00,  1.27it/s]
1 (0.46215596330275227, 0.8926920450989942, 0.5295752871249345)
Avg [0.46215596330275227, 0.8926920450989942, 0.5295752871249345]

train Epoch 24 (lr 0.000100)
loss: 0.4086 	
Running time: 191.10530710220337
valid   mortality   4   cnn
100%|██████████| 35/35 [01:45<00:00,  3.02s/it]
1 (0.34042553191489366, 0.819156351400072, 0.376241988817497)
Avg [0.34042553191489366, 0.819156351400072, 0.376241988817497]

valid Epoch 24 (lr 0.000100)
loss: 0.5257 	
				 best epoch: 18     best AUC: 0.8210 	
best metric [0.8209960741898009, 18]

Process finished with exit code 0