/Users/luis/opt/anaconda3/envs/CS598FinalProject/bin/python /Users/luis/PycharmProjects/clinical-fusion/main.py 
Use the last 24 collections data
Use the last 24 collections data
Use the last 24 collections data
start epoch : 0
train
100%|██████████| 243/243 [03:50<00:00,  1.06it/s]
1 (0.6111991129415492, 0.6255965087869748, 0.5896501886265529)
Avg [0.6111991129415492, 0.6255965087869748, 0.5896501886265529]

train Epoch 0 (lr 0.000100)
loss: 0.6845 	
Running time: 230.19428610801697
valid
100%|██████████| 35/35 [02:05<00:00,  3.57s/it]
1 (0.6672158154859967, 0.6916416861826697, 0.6657592449102457)
Avg [0.6672158154859967, 0.6916416861826697, 0.6657592449102457]

valid Epoch 0 (lr 0.000100)
loss: 0.6332 	
				 best epoch: 0     best AUC: 0.6916 	
start epoch : 1
train
100%|██████████| 243/243 [02:30<00:00,  1.62it/s]
1 (0.6479765772269683, 0.6833311488948768, 0.6476051294695375)
Avg [0.6479765772269683, 0.6833311488948768, 0.6476051294695375]

train Epoch 1 (lr 0.000100)
loss: 0.6434 	
Running time: 150.08263421058655
valid
100%|██████████| 35/35 [01:45<00:00,  3.00s/it]
1 (0.6879394267171445, 0.7069675476748076, 0.6758845014435202)
Avg [0.6879394267171445, 0.7069675476748076, 0.6758845014435202]

valid Epoch 1 (lr 0.000100)
loss: 0.6237 	
				 best epoch: 1     best AUC: 0.7070 	
start epoch : 2
train
100%|██████████| 243/243 [02:53<00:00,  1.40it/s]
1 (0.6452152110321772, 0.7013781222671753, 0.6669240441933009)
Avg [0.6452152110321772, 0.7013781222671753, 0.6669240441933009]

train Epoch 2 (lr 0.000100)
loss: 0.6298 	
Running time: 173.3681778907776
valid
100%|██████████| 35/35 [01:52<00:00,  3.22s/it]
1 (0.6909389542841501, 0.7185690866510539, 0.6915767454585455)
Avg [0.6909389542841501, 0.7185690866510539, 0.6915767454585455]

valid Epoch 2 (lr 0.000100)
loss: 0.6167 	
				 best epoch: 2     best AUC: 0.7186 	
start epoch : 3
train
100%|██████████| 243/243 [02:13<00:00,  1.82it/s]
1 (0.6542475778618653, 0.712200709165025, 0.6806329926141053)
Avg [0.6542475778618653, 0.712200709165025, 0.6806329926141053]

train Epoch 3 (lr 0.000100)
loss: 0.6199 	
Running time: 133.5801441669464
valid
100%|██████████| 35/35 [01:55<00:00,  3.29s/it]
1 (0.6887343532684285, 0.7231492137838741, 0.697073897373567)
Avg [0.6887343532684285, 0.7231492137838741, 0.697073897373567]

valid Epoch 3 (lr 0.000100)
loss: 0.6137 	
				 best epoch: 3     best AUC: 0.7231 	
start epoch : 4
train
100%|██████████| 243/243 [02:14<00:00,  1.80it/s]
1 (0.6715934965845085, 0.7173712715767653, 0.6864682989980446)
Avg [0.6715934965845085, 0.7173712715767653, 0.6864682989980446]

train Epoch 4 (lr 0.000100)
loss: 0.6176 	
Running time: 134.7894139289856
valid
100%|██████████| 35/35 [01:46<00:00,  3.04s/it]
1 (0.6828442437923251, 0.7263312144529943, 0.7009587342803193)
Avg [0.6828442437923251, 0.7263312144529943, 0.7009587342803193]

valid Epoch 4 (lr 0.000100)
loss: 0.6097 	
				 best epoch: 4     best AUC: 0.7263 	
start epoch : 5
train
100%|██████████| 243/243 [02:36<00:00,  1.55it/s]
1 (0.662944754603783, 0.7248083317465135, 0.6957334886807406)
Avg [0.662944754603783, 0.7248083317465135, 0.6957334886807406]

train Epoch 5 (lr 0.000100)
loss: 0.6093 	
Running time: 156.7827970981598
valid
100%|██████████| 35/35 [01:52<00:00,  3.20s/it]
1 (0.685874125874126, 0.7268360655737705, 0.7028826750466861)
Avg [0.685874125874126, 0.7268360655737705, 0.7028826750466861]

valid Epoch 5 (lr 0.000100)
loss: 0.6101 	
				 best epoch: 5     best AUC: 0.7268 	
start epoch : 6
train
100%|██████████| 243/243 [02:34<00:00,  1.57it/s]
1 (0.679578606158833, 0.7326292338378646, 0.706227193455992)
Avg [0.679578606158833, 0.7326292338378646, 0.706227193455992]

train Epoch 6 (lr 0.000100)
loss: 0.6037 	
Running time: 155.01886796951294
valid
100%|██████████| 35/35 [01:51<00:00,  3.19s/it]
1 (0.686550365785031, 0.7289902977584476, 0.7067439651920713)
Avg [0.686550365785031, 0.7289902977584476, 0.7067439651920713]

valid Epoch 6 (lr 0.000100)
loss: 0.6080 	
				 best epoch: 6     best AUC: 0.7290 	
start epoch : 7
train
100%|██████████| 243/243 [02:47<00:00,  1.45it/s]
1 (0.6720543744042439, 0.735527851624471, 0.7070310626557537)
Avg [0.6720543744042439, 0.735527851624471, 0.7070310626557537]

train Epoch 7 (lr 0.000100)
loss: 0.6014 	
Running time: 167.7734661102295
valid
100%|██████████| 35/35 [01:50<00:00,  3.15s/it]
1 (0.6933407946278679, 0.7322914018066242, 0.7066073763379792)
Avg [0.6933407946278679, 0.7322914018066242, 0.7066073763379792]

valid Epoch 7 (lr 0.000100)
loss: 0.6071 	
				 best epoch: 7     best AUC: 0.7323 	
start epoch : 8
train
100%|██████████| 243/243 [02:28<00:00,  1.63it/s]
1 (0.6795141033559811, 0.7397772992882397, 0.7129386187979927)
Avg [0.6795141033559811, 0.7397772992882397, 0.7129386187979927]

train Epoch 8 (lr 0.000100)
loss: 0.5974 	
Running time: 148.76429224014282
valid
100%|██████████| 35/35 [01:42<00:00,  2.93s/it]
1 (0.6937187326292384, 0.7341385078621612, 0.710529473380054)
Avg [0.6937187326292384, 0.7341385078621612, 0.710529473380054]

valid Epoch 8 (lr 0.000100)
loss: 0.6050 	
				 best epoch: 8     best AUC: 0.7341 	
start epoch : 9
train
100%|██████████| 243/243 [02:12<00:00,  1.84it/s]
1 (0.683801896044459, 0.7449536124988765, 0.7188679836896152)
Avg [0.683801896044459, 0.7449536124988765, 0.7188679836896152]

train Epoch 9 (lr 0.000100)
loss: 0.5923 	
Running time: 132.19586277008057
valid
100%|██████████| 35/35 [01:48<00:00,  3.10s/it]
1 (0.7060097455332972, 0.7359595182335228, 0.710016912943136)
Avg [0.7060097455332972, 0.7359595182335228, 0.710016912943136]

valid Epoch 9 (lr 0.000100)
loss: 0.6041 	
				 best epoch: 9     best AUC: 0.7360 	
start epoch : 10
train
100%|██████████| 243/243 [02:16<00:00,  1.78it/s]
1 (0.6840471756672873, 0.7480868451226532, 0.7200452463134881)
Avg [0.6840471756672873, 0.7480868451226532, 0.7200452463134881]

train Epoch 10 (lr 0.000100)
loss: 0.5907 	
Running time: 136.6287980079651
valid
100%|██████████| 35/35 [02:20<00:00,  4.02s/it]
1 (0.6947779949734711, 0.7350066912010706, 0.7117437845904486)
Avg [0.6947779949734711, 0.7350066912010706, 0.7117437845904486]

valid Epoch 10 (lr 0.000100)
loss: 0.6042 	
				 best epoch: 9     best AUC: 0.7360 	
start epoch : 11
train
100%|██████████| 243/243 [03:13<00:00,  1.25it/s]
1 (0.6892376127517608, 0.7533853423200608, 0.7295625873936119)
Avg [0.6892376127517608, 0.7533853423200608, 0.7295625873936119]

train Epoch 11 (lr 0.000100)
loss: 0.5850 	
Running time: 193.94776701927185
valid
100%|██████████| 35/35 [01:45<00:00,  3.02s/it]
1 (0.6988085342200054, 0.7363576446972233, 0.7161763324842708)
Avg [0.6988085342200054, 0.7363576446972233, 0.7161763324842708]

valid Epoch 11 (lr 0.000100)
loss: 0.6012 	
				 best epoch: 11     best AUC: 0.7364 	
start epoch : 12
train
100%|██████████| 243/243 [02:15<00:00,  1.79it/s]
1 (0.6984969053934571, 0.7547033783006649, 0.7306078275352674)
Avg [0.6984969053934571, 0.7547033783006649, 0.7306078275352674]

train Epoch 12 (lr 0.000100)
loss: 0.5867 	
Running time: 135.59218096733093
valid
100%|██████████| 35/35 [01:44<00:00,  2.99s/it]
1 (0.7031763417305587, 0.7386728002676479, 0.7185891080881177)
Avg [0.7031763417305587, 0.7386728002676479, 0.7185891080881177]

valid Epoch 12 (lr 0.000100)
loss: 0.6026 	
				 best epoch: 12     best AUC: 0.7387 	
start epoch : 13
train
100%|██████████| 243/243 [02:08<00:00,  1.89it/s]
1 (0.6976819845465637, 0.7617987508609123, 0.7386768862588071)
Avg [0.6976819845465637, 0.7617987508609123, 0.7386768862588071]

train Epoch 13 (lr 0.000100)
loss: 0.5770 	
Running time: 128.49593997001648
valid
100%|██████████| 35/35 [01:41<00:00,  2.91s/it]
1 (0.6969187675070028, 0.7393599866175978, 0.7167818321498121)
Avg [0.6969187675070028, 0.7393599866175978, 0.7167818321498121]

valid Epoch 13 (lr 0.000100)
loss: 0.6001 	
				 best epoch: 13     best AUC: 0.7394 	
start epoch : 14
train
100%|██████████| 243/243 [02:50<00:00,  1.42it/s]
1 (0.6871243545246762, 0.7643488340357685, 0.7430728485599892)
Avg [0.6871243545246762, 0.7643488340357685, 0.7430728485599892]

train Epoch 14 (lr 0.000100)
loss: 0.5745 	
Running time: 170.68901705741882
valid
100%|██████████| 35/35 [01:39<00:00,  2.84s/it]
1 (0.7048242027800491, 0.7408962863834058, 0.7211591881827448)
Avg [0.7048242027800491, 0.7408962863834058, 0.7211591881827448]

valid Epoch 14 (lr 0.000100)
loss: 0.5982 	
				 best epoch: 14     best AUC: 0.7409 	
start epoch : 15
train
100%|██████████| 243/243 [02:08<00:00,  1.90it/s]
1 (0.7000163746520387, 0.7671783192969218, 0.7464738940713513)
Avg [0.7000163746520387, 0.7671783192969218, 0.7464738940713513]

train Epoch 15 (lr 0.000100)
loss: 0.5741 	
Running time: 128.22088980674744
valid
100%|██████████| 35/35 [01:47<00:00,  3.06s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.696629213483146, 0.7424713951154231, 0.7217215725787579)
Avg [0.696629213483146, 0.7424713951154231, 0.7217215725787579]

valid Epoch 15 (lr 0.000100)
loss: 0.5981 	
				 best epoch: 15     best AUC: 0.7425 	
start epoch : 16
train
100%|██████████| 243/243 [02:19<00:00,  1.74it/s]
1 (0.7007672634271099, 0.7729973559984931, 0.7537682833910696)
Avg [0.7007672634271099, 0.7729973559984931, 0.7537682833910696]

train Epoch 16 (lr 0.000100)
loss: 0.5673 	
Running time: 140.03175401687622
valid
100%|██████████| 35/35 [01:54<00:00,  3.28s/it]
1 (0.7024793388429752, 0.7425613917698226, 0.7212116222168639)
Avg [0.7024793388429752, 0.7425613917698226, 0.7212116222168639]

valid Epoch 16 (lr 0.000100)
loss: 0.5971 	
				 best epoch: 16     best AUC: 0.7426 	
start epoch : 17
train
100%|██████████| 243/243 [02:13<00:00,  1.83it/s]
1 (0.6969211303247573, 0.773277393268041, 0.7526305300990218)
Avg [0.6969211303247573, 0.773277393268041, 0.7526305300990218]

train Epoch 17 (lr 0.000100)
loss: 0.5672 	
Running time: 133.11551880836487
valid
100%|██████████| 35/35 [02:01<00:00,  3.47s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.6985191394244202, 0.7429782535965206, 0.7204458290457376)
Avg [0.6985191394244202, 0.7429782535965206, 0.7204458290457376]

valid Epoch 17 (lr 0.000100)
loss: 0.5992 	
				 best epoch: 17     best AUC: 0.7430 	
start epoch : 18
train
100%|██████████| 243/243 [02:08<00:00,  1.89it/s]
1 (0.7109685800113664, 0.777280953299415, 0.7573172093689311)
Avg [0.7109685800113664, 0.777280953299415, 0.7573172093689311]

train Epoch 18 (lr 0.000100)
loss: 0.5636 	
Running time: 128.3829312324524
valid
100%|██████████| 35/35 [01:54<00:00,  3.28s/it]
1 (0.6904559614839988, 0.7411455336232854, 0.7203168821346031)
Avg [0.6904559614839988, 0.7411455336232854, 0.7203168821346031]

valid Epoch 18 (lr 0.000100)
loss: 0.5980 	
				 best epoch: 17     best AUC: 0.7430 	
start epoch : 19
train
100%|██████████| 243/243 [02:07<00:00,  1.90it/s]
1 (0.7083665004817965, 0.7830970258124814, 0.7644783160814663)
Avg [0.7083665004817965, 0.7830970258124814, 0.7644783160814663]

train Epoch 19 (lr 0.000100)
loss: 0.5575 	
Running time: 127.93940711021423
valid
100%|██████████| 35/35 [01:46<00:00,  3.05s/it]
1 (0.6879310344827587, 0.7422796922047508, 0.7212344015291426)
Avg [0.6879310344827587, 0.7422796922047508, 0.7212344015291426]

valid Epoch 19 (lr 0.000100)
loss: 0.5968 	
				 best epoch: 17     best AUC: 0.7430 	
start epoch : 20
train
100%|██████████| 243/243 [02:09<00:00,  1.87it/s]
1 (0.7146355399559219, 0.7830326093519191, 0.7627099491090492)
Avg [0.7146355399559219, 0.7830326093519191, 0.7627099491090492]

train Epoch 20 (lr 0.000100)
loss: 0.5576 	
Running time: 129.70769834518433
valid
100%|██████████| 35/35 [01:41<00:00,  2.90s/it]
1 (0.6923293059848272, 0.7434051522248244, 0.7263424291613725)
Avg [0.6923293059848272, 0.7434051522248244, 0.7263424291613725]

valid Epoch 20 (lr 0.000100)
loss: 0.5974 	
				 best epoch: 20     best AUC: 0.7434 	
start epoch : 21
train
100%|██████████| 243/243 [03:17<00:00,  1.23it/s]
1 (0.7115472198070633, 0.7843315147057899, 0.7679872234523191)
Avg [0.7115472198070633, 0.7843315147057899, 0.7679872234523191]

train Epoch 21 (lr 0.000100)
loss: 0.5546 	
Running time: 197.1468071937561
valid
100%|██████████| 35/35 [01:40<00:00,  2.88s/it]
1 (0.6910336950314105, 0.7447664770826363, 0.7238056982722699)
Avg [0.6910336950314105, 0.7447664770826363, 0.7238056982722699]

valid Epoch 21 (lr 0.000100)
loss: 0.5952 	
				 best epoch: 21     best AUC: 0.7448 	
start epoch : 22
train
100%|██████████| 243/243 [02:08<00:00,  1.90it/s]
1 (0.7128531602380062, 0.7876540353533437, 0.7722265543897421)
Avg [0.7128531602380062, 0.7876540353533437, 0.7722265543897421]

train Epoch 22 (lr 0.000100)
loss: 0.5531 	
Running time: 128.07850909233093
valid
100%|██████████| 35/35 [01:40<00:00,  2.87s/it]
1 (0.6948863636363636, 0.7441291401806625, 0.7244556732809608)
Avg [0.6948863636363636, 0.7441291401806625, 0.7244556732809608]

valid Epoch 22 (lr 0.000100)
loss: 0.5953 	
				 best epoch: 21     best AUC: 0.7448 	
start epoch : 23
train
100%|██████████| 243/243 [02:05<00:00,  1.93it/s]
1 (0.720226843100189, 0.7926131841913953, 0.774561090530786)
Avg [0.720226843100189, 0.7926131841913953, 0.774561090530786]

train Epoch 23 (lr 0.000100)
loss: 0.5480 	
Running time: 125.91909503936768
valid
100%|██████████| 35/35 [01:42<00:00,  2.92s/it]
1 (0.7012630422844592, 0.7440140515222484, 0.7243954679411135)
Avg [0.7012630422844592, 0.7440140515222484, 0.7243954679411135]

valid Epoch 23 (lr 0.000100)
loss: 0.5983 	
				 best epoch: 21     best AUC: 0.7448 	
start epoch : 24
train
100%|██████████| 243/243 [02:10<00:00,  1.87it/s]
1 (0.7175007279836932, 0.7942423301963932, 0.7796537203436891)
Avg [0.7175007279836932, 0.7942423301963932, 0.7796537203436891]

train Epoch 24 (lr 0.000100)
loss: 0.5459 	
Running time: 130.22700786590576
valid
100%|██████████| 35/35 [02:17<00:00,  3.92s/it]
1 (0.6858789625360231, 0.745384074941452, 0.7267141896317857)
Avg [0.6858789625360231, 0.745384074941452, 0.7267141896317857]

valid Epoch 24 (lr 0.000100)
loss: 0.5950 	
				 best epoch: 24     best AUC: 0.7454 	
best metric [0.745384074941452, 24]

Process finished with exit code 0