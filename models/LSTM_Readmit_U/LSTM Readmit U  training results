/Users/luis/opt/anaconda3/envs/CS598FinalProject/bin/python /Users/luis/PycharmProjects/clinical-fusion/main.py 
Use the last 24 collections data
Use the last 24 collections data
Use the last 24 collections data
start epoch : 0
train   readmit   4   lstm
100%|██████████| 243/243 [03:39<00:00,  1.11it/s]
1 (0.11895526247737263, 0.562651004922571, 0.07480736821783017)
Avg [0.11895526247737263, 0.562651004922571, 0.07480736821783017]

train Epoch 0 (lr 0.000100)
loss: 0.6865 	
Running time: 219.2364580631256
valid   readmit   4   lstm
100%|██████████| 35/35 [01:48<00:00,  3.09s/it]
1 (0.14344991108476585, 0.6093186003683241, 0.0937998585100149)
Avg [0.14344991108476585, 0.6093186003683241, 0.0937998585100149]

valid Epoch 0 (lr 0.000100)
loss: 0.6664 	
				 best epoch: 0     best AUC: 0.6093 	
start epoch : 1
train   readmit   4   lstm
100%|██████████| 243/243 [03:04<00:00,  1.32it/s]
1 (0.14503249767873724, 0.6415680784935542, 0.1018616662684466)
Avg [0.14503249767873724, 0.6415680784935542, 0.1018616662684466]

train Epoch 1 (lr 0.000100)
loss: 0.6626 	
Running time: 184.15193486213684
valid   readmit   4   lstm
100%|██████████| 35/35 [01:48<00:00,  3.11s/it]
1 (0.1570048309178744, 0.655414364640884, 0.11442729748141645)
Avg [0.1570048309178744, 0.655414364640884, 0.11442729748141645]

valid Epoch 1 (lr 0.000100)
loss: 0.6500 	
				 best epoch: 1     best AUC: 0.6554 	
start epoch : 2
train   readmit   4   lstm
100%|██████████| 243/243 [03:02<00:00,  1.33it/s]
1 (0.15305560653330888, 0.6645354274598876, 0.11391015136595142)
Avg [0.15305560653330888, 0.6645354274598876, 0.11391015136595142]

train Epoch 2 (lr 0.000100)
loss: 0.6454 	
Running time: 182.23038482666016
valid   readmit   4   lstm
100%|██████████| 35/35 [01:47<00:00,  3.07s/it]
1 (0.16159105034182722, 0.6631399631675874, 0.12186422307720485)
Avg [0.16159105034182722, 0.6631399631675874, 0.12186422307720485]

valid Epoch 2 (lr 0.000100)
loss: 0.6403 	
				 best epoch: 2     best AUC: 0.6631 	
start epoch : 3
train   readmit   4   lstm
100%|██████████| 243/243 [02:36<00:00,  1.55it/s]
1 (0.160235749148172, 0.6807174520534056, 0.122416201988956)
Avg [0.160235749148172, 0.6807174520534056, 0.122416201988956]

train Epoch 3 (lr 0.000100)
loss: 0.6410 	
Running time: 156.85641193389893
valid   readmit   4   lstm
100%|██████████| 35/35 [01:48<00:00,  3.11s/it]
1 (0.15805109922756982, 0.6615837937384899, 0.12736547975362333)
Avg [0.15805109922756982, 0.6615837937384899, 0.12736547975362333]

valid Epoch 3 (lr 0.000100)
loss: 0.6440 	
				 best epoch: 2     best AUC: 0.6631 	
start epoch : 4
train   readmit   4   lstm
100%|██████████| 243/243 [02:57<00:00,  1.37it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.1646712463199215, 0.6883378274419093, 0.12662558605367027)
Avg [0.1646712463199215, 0.6883378274419093, 0.12662558605367027]

train Epoch 4 (lr 0.000100)
loss: 0.6322 	
Running time: 177.25639605522156
valid   readmit   4   lstm
100%|██████████| 35/35 [01:49<00:00,  3.14s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.16010006253908696, 0.6592556783302641, 0.12850585430058614)
Avg [0.16010006253908696, 0.6592556783302641, 0.12850585430058614]

valid Epoch 4 (lr 0.000100)
loss: 0.6407 	
				 best epoch: 2     best AUC: 0.6631 	
start epoch : 5
train   readmit   4   lstm
100%|██████████| 243/243 [02:58<00:00,  1.36it/s]
1 (0.1676328977105237, 0.6959063653196796, 0.12784547020196513)
Avg [0.1676328977105237, 0.6959063653196796, 0.12784547020196513]

train Epoch 5 (lr 0.000100)
loss: 0.6338 	
Running time: 178.84713006019592
valid   readmit   4   lstm
100%|██████████| 35/35 [01:53<00:00,  3.24s/it]
1 (0.1663172606568833, 0.6595303867403314, 0.12603073931226433)
Avg [0.1663172606568833, 0.6595303867403314, 0.12603073931226433]

valid Epoch 5 (lr 0.000100)
loss: 0.6406 	
				 best epoch: 2     best AUC: 0.6631 	
start epoch : 6
train   readmit   4   lstm
100%|██████████| 243/243 [02:38<00:00,  1.53it/s]
1 (0.17141760245704962, 0.7052376562050057, 0.13758024980615816)
Avg [0.17141760245704962, 0.7052376562050057, 0.13758024980615816]

train Epoch 6 (lr 0.000100)
loss: 0.6271 	
Running time: 158.99119997024536
valid   readmit   4   lstm
100%|██████████| 35/35 [01:47<00:00,  3.07s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.17492260061919504, 0.6630417434008593, 0.1315912408550409)
Avg [0.17492260061919504, 0.6630417434008593, 0.1315912408550409]

valid Epoch 6 (lr 0.000100)
loss: 0.6434 	
				 best epoch: 2     best AUC: 0.6631 	
start epoch : 7
train   readmit   4   lstm
100%|██████████| 243/243 [02:33<00:00,  1.58it/s]
1 (0.17319098457888496, 0.7070948403679045, 0.1433919525748796)
Avg [0.17319098457888496, 0.7070948403679045, 0.1433919525748796]

train Epoch 7 (lr 0.000100)
loss: 0.6196 	
Running time: 153.43636393547058
valid   readmit   4   lstm
100%|██████████| 35/35 [01:50<00:00,  3.16s/it]
1 (0.15789473684210525, 0.6646286065070596, 0.13106174641615756)
Avg [0.15789473684210525, 0.6646286065070596, 0.13106174641615756]

valid Epoch 7 (lr 0.000100)
loss: 0.6384 	
				 best epoch: 7     best AUC: 0.6646 	
start epoch : 8
train   readmit   4   lstm
100%|██████████| 243/243 [03:22<00:00,  1.20it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.17929071803852892, 0.7103741100410728, 0.14404141755142413)
Avg [0.17929071803852892, 0.7103741100410728, 0.14404141755142413]

train Epoch 8 (lr 0.000100)
loss: 0.6173 	
Running time: 202.05561089515686
valid   readmit   4   lstm
100%|██████████| 35/35 [01:42<00:00,  2.92s/it]
1 (0.16737588652482266, 0.659585635359116, 0.1305846533030187)
Avg [0.16737588652482266, 0.659585635359116, 0.1305846533030187]

valid Epoch 8 (lr 0.000100)
loss: 0.6425 	
				 best epoch: 7     best AUC: 0.6646 	
start epoch : 9
train   readmit   4   lstm
100%|██████████| 243/243 [02:22<00:00,  1.70it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.17024053701286596, 0.7154093876392721, 0.1454130538942955)
Avg [0.17024053701286596, 0.7154093876392721, 0.1454130538942955]

train Epoch 9 (lr 0.000100)
loss: 0.6177 	
Running time: 142.86557006835938
valid   readmit   4   lstm
100%|██████████| 35/35 [01:41<00:00,  2.89s/it]
1 (0.17065868263473052, 0.6529527317372621, 0.1327008668936287)
Avg [0.17065868263473052, 0.6529527317372621, 0.1327008668936287]

valid Epoch 9 (lr 0.000100)
loss: 0.6574 	
				 best epoch: 7     best AUC: 0.6646 	
start epoch : 10
train   readmit   4   lstm
100%|██████████| 243/243 [02:25<00:00,  1.67it/s]
1 (0.1693861693861694, 0.7194314656499241, 0.15034646016723544)
Avg [0.1693861693861694, 0.7194314656499241, 0.15034646016723544]

train Epoch 10 (lr 0.000100)
loss: 0.6128 	
Running time: 145.7248079776764
valid   readmit   4   lstm
100%|██████████| 35/35 [01:42<00:00,  2.94s/it]
1 (0.15904821540388228, 0.6561648250460406, 0.13849122141642597)
Avg [0.15904821540388228, 0.6561648250460406, 0.13849122141642597]

valid Epoch 10 (lr 0.000100)
loss: 0.6447 	
				 best epoch: 7     best AUC: 0.6646 	
start epoch : 11
train   readmit   4   lstm
100%|██████████| 243/243 [02:26<00:00,  1.66it/s]
1 (0.18037720706260033, 0.7268571155688394, 0.1601483552649895)
Avg [0.18037720706260033, 0.7268571155688394, 0.1601483552649895]

train Epoch 11 (lr 0.000100)
loss: 0.6099 	
Running time: 146.8616168498993
valid   readmit   4   lstm
100%|██████████| 35/35 [01:43<00:00,  2.96s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.17083946980854198, 0.6664556476365869, 0.14689429040846644)
Avg [0.17083946980854198, 0.6664556476365869, 0.14689429040846644]

valid Epoch 11 (lr 0.000100)
loss: 0.6416 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 12
train   readmit   4   lstm
100%|██████████| 243/243 [02:55<00:00,  1.38it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.1769724858594574, 0.7290771786387907, 0.16154851369427972)
Avg [0.1769724858594574, 0.7290771786387907, 0.16154851369427972]

train Epoch 12 (lr 0.000100)
loss: 0.6070 	
Running time: 175.95974922180176
valid   readmit   4   lstm
100%|██████████| 35/35 [01:43<00:00,  2.95s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.1702442635085122, 0.6492111724984653, 0.12537355329051453)
Avg [0.1702442635085122, 0.6492111724984653, 0.12537355329051453]

valid Epoch 12 (lr 0.000100)
loss: 0.6581 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 13
train   readmit   4   lstm
100%|██████████| 243/243 [02:24<00:00,  1.69it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.17953149001536098, 0.7358496334594766, 0.17007157514787286)
Avg [0.17953149001536098, 0.7358496334594766, 0.17007157514787286]

train Epoch 13 (lr 0.000100)
loss: 0.5954 	
Running time: 144.2244758605957
valid   readmit   4   lstm
100%|██████████| 35/35 [01:43<00:00,  2.96s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.15584415584415584, 0.6660957642725598, 0.13263878304866814)
Avg [0.15584415584415584, 0.6660957642725598, 0.13263878304866814]

valid Epoch 13 (lr 0.000100)
loss: 0.6508 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 14
train   readmit   4   lstm
100%|██████████| 243/243 [02:28<00:00,  1.64it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.1799052132701422, 0.7363337115370243, 0.17367576373262897)
Avg [0.1799052132701422, 0.7363337115370243, 0.17367576373262897]

train Epoch 14 (lr 0.000100)
loss: 0.5908 	
Running time: 148.3376820087433
valid   readmit   4   lstm
100%|██████████| 35/35 [01:43<00:00,  2.96s/it]
1 (0.17086834733893555, 0.6627163904235728, 0.14394456512855558)
Avg [0.17086834733893555, 0.6627163904235728, 0.14394456512855558]

valid Epoch 14 (lr 0.000100)
loss: 0.6516 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 15
train   readmit   4   lstm
100%|██████████| 243/243 [02:27<00:00,  1.65it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.1787657099981242, 0.7408229314252774, 0.1768353987969293)
Avg [0.1787657099981242, 0.7408229314252774, 0.1768353987969293]

train Epoch 15 (lr 0.000100)
loss: 0.5929 	
Running time: 147.60079717636108
valid   readmit   4   lstm
100%|██████████| 35/35 [01:44<00:00,  2.98s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.17134831460674158, 0.6561970534069981, 0.14165959520030316)
Avg [0.17134831460674158, 0.6561970534069981, 0.14165959520030316]

valid Epoch 15 (lr 0.000100)
loss: 0.6682 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 16
train   readmit   4   lstm
100%|██████████| 243/243 [02:29<00:00,  1.63it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.18351115421920464, 0.7444588412124608, 0.1837586241633304)
Avg [0.18351115421920464, 0.7444588412124608, 0.1837586241633304]

train Epoch 16 (lr 0.000100)
loss: 0.5837 	
Running time: 149.1525580883026
valid   readmit   4   lstm
100%|██████████| 35/35 [01:44<00:00,  2.99s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.15721040189125296, 0.6596439533456108, 0.14556356513510715)
Avg [0.15721040189125296, 0.6596439533456108, 0.14556356513510715]

valid Epoch 16 (lr 0.000100)
loss: 0.6802 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 17
train   readmit   4   lstm
100%|██████████| 243/243 [02:28<00:00,  1.64it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.18083013210906024, 0.7503899245648262, 0.19130399724652644)
Avg [0.18083013210906024, 0.7503899245648262, 0.19130399724652644]

train Epoch 17 (lr 0.000100)
loss: 0.5732 	
Running time: 148.16375994682312
valid   readmit   4   lstm
100%|██████████| 35/35 [01:43<00:00,  2.97s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.17251461988304093, 0.663341006752609, 0.1358645914931791)
Avg [0.17251461988304093, 0.663341006752609, 0.1358645914931791]

valid Epoch 17 (lr 0.000100)
loss: 0.6676 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 18
train   readmit   4   lstm
100%|██████████| 243/243 [02:29<00:00,  1.62it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.18561530203962134, 0.75369543963174, 0.195374851221168)
Avg [0.18561530203962134, 0.75369543963174, 0.195374851221168]

train Epoch 18 (lr 0.000100)
loss: 0.5759 	
Running time: 149.92321395874023
valid   readmit   4   lstm
100%|██████████| 35/35 [01:44<00:00,  3.00s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.16010165184243966, 0.6508410067526089, 0.14017865899936321)
Avg [0.16010165184243966, 0.6508410067526089, 0.14017865899936321]

valid Epoch 18 (lr 0.000100)
loss: 0.7145 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 19
train   readmit   4   lstm
100%|██████████| 243/243 [02:29<00:00,  1.62it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.19142051977872876, 0.7578911749365407, 0.20219041392818193)
Avg [0.19142051977872876, 0.7578911749365407, 0.20219041392818193]

train Epoch 19 (lr 0.000100)
loss: 0.5650 	
Running time: 149.91446709632874
valid   readmit   4   lstm
100%|██████████| 35/35 [01:42<00:00,  2.93s/it]
1 (0.16186556927297668, 0.6475905463474525, 0.13614109924951745)
Avg [0.16186556927297668, 0.6475905463474525, 0.13614109924951745]

valid Epoch 19 (lr 0.000100)
loss: 0.7714 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 20
train   readmit   4   lstm
100%|██████████| 243/243 [02:27<00:00,  1.65it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.18906394810009267, 0.761549622771869, 0.21171456902810415)
Avg [0.18906394810009267, 0.761549622771869, 0.21171456902810415]

train Epoch 20 (lr 0.000100)
loss: 0.5650 	
Running time: 147.7409610748291
valid   readmit   4   lstm
100%|██████████| 35/35 [01:44<00:00,  2.99s/it]
1 (0.15924764890282134, 0.6408686310620013, 0.1319578609560939)
Avg [0.15924764890282134, 0.6408686310620013, 0.1319578609560939]

valid Epoch 20 (lr 0.000100)
loss: 0.7339 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 21
train   readmit   4   lstm
100%|██████████| 243/243 [02:25<00:00,  1.67it/s]
1 (0.19333808699195276, 0.7681963708124308, 0.21842475761842844)
Avg [0.19333808699195276, 0.7681963708124308, 0.21842475761842844]

train Epoch 21 (lr 0.000100)
loss: 0.5566 	
Running time: 145.90198802947998
valid   readmit   4   lstm
100%|██████████| 35/35 [01:47<00:00,  3.06s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.1708542713567839, 0.6515039901780234, 0.13245369085639758)
Avg [0.1708542713567839, 0.6515039901780234, 0.13245369085639758]

valid Epoch 21 (lr 0.000100)
loss: 0.7668 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 22
train   readmit   4   lstm
100%|██████████| 243/243 [02:29<00:00,  1.63it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.1958855995985951, 0.7783389497713792, 0.23021086405753122)
Avg [0.1958855995985951, 0.7783389497713792, 0.23021086405753122]

train Epoch 22 (lr 0.000100)
loss: 0.5471 	
Running time: 149.5313332080841
valid   readmit   4   lstm
100%|██████████| 35/35 [01:44<00:00,  2.99s/it]
1 (0.17975567190226877, 0.6397283609576426, 0.12652256364985304)
Avg [0.17975567190226877, 0.6397283609576426, 0.12652256364985304]

valid Epoch 22 (lr 0.000100)
loss: 0.8350 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 23
train   readmit   4   lstm
100%|██████████| 243/243 [02:30<00:00,  1.61it/s]
1 (0.19151768733358693, 0.7790569335920657, 0.228608445934795)
Avg [0.19151768733358693, 0.7790569335920657, 0.228608445934795]

train Epoch 23 (lr 0.000100)
loss: 0.5556 	
Running time: 150.7602789402008
valid   readmit   4   lstm
100%|██████████| 35/35 [01:43<00:00,  2.97s/it]
  0%|          | 0/243 [00:00<?, ?it/s]1 (0.16268560361523562, 0.6555478821362799, 0.12728110916913069)
Avg [0.16268560361523562, 0.6555478821362799, 0.12728110916913069]

valid Epoch 23 (lr 0.000100)
loss: 0.7809 	
				 best epoch: 11     best AUC: 0.6665 	
start epoch : 24
train   readmit   4   lstm
100%|██████████| 243/243 [02:37<00:00,  1.55it/s]
  0%|          | 0/35 [00:00<?, ?it/s]1 (0.19759130519925586, 0.7842540931708537, 0.23835610200599738)
Avg [0.19759130519925586, 0.7842540931708537, 0.23835610200599738]

train Epoch 24 (lr 0.000100)
loss: 0.5413 	
Running time: 157.26034498214722
valid   readmit   4   lstm
100%|██████████| 35/35 [01:45<00:00,  3.00s/it]
1 (0.16612589227774172, 0.6509085328422345, 0.13316461209411537)
Avg [0.16612589227774172, 0.6509085328422345, 0.13316461209411537]

valid Epoch 24 (lr 0.000100)
loss: 0.8614 	
				 best epoch: 11     best AUC: 0.6665 	
best metric [0.6664556476365869, 11]

Process finished with exit code 0